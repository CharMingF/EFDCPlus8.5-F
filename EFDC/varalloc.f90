SUBROUTINE VARALLOC

  !----------------------------------------------------------------------!  
  ! CHANGE RECORD  
  ! DATE MODIFIED     BY               DESCRIPTION
  !----------------------------------------------------------------------!
  !    2015-06       PAUL M. CRAIG     IMPLEMENTED SIGMA-Z (SGZ) IN EE7.3 

  USE GLOBAL
  
  INTEGER :: NMAXBC,L
  
  WRITE(*,'(A)')'ALLOCATING ARRAYS'

  ! *** REPORT ARRAY SIZES
  OPEN(888,FILE=OUTDIR//'ARRAYSIZES.LOG',STATUS='UNKNOWN')
  WRITE(888,'(A,//)') RUNTITLE
  
  WRITE(888,'(A,I10)') 'MAXIMUM L ARRAY (LCM): ',LCM
  WRITE(888,'(A,I10)') 'MAXIMUM K ARRAY (KCM): ',KCM
  WRITE(888,'(A,I10)') 'MAXIMUM I ARRAY (ICM): ',ICM
  WRITE(888,'(A,I10)') 'MAXIMUM J ARRAY (JCM): ',JCM
  WRITE(888,'(A,I10)')
  WRITE(888,'(A,I10)') 'NUMBER OF COHESIVES (NSCM): ',NSCM
  WRITE(888,'(A,I10)') 'NUMBER OF NON-COHESIVES (NSNM): ',NSNM
  WRITE(888,'(A,I10)') 'NUMBER OF TOXICS (NTXM): ',NTXM
  WRITE(888,'(A,I10)') 'NUMBER OF WATER QUALITY CONSTITUENTS (NWQV): ',NWQV
  WRITE(888,'(A,I10)') 'MAXIMUM NUMBER OF CONSTITUENTS (NSTVM): ',NSTVM
  WRITE(888,'(A,I10)')
  WRITE(888,'(A,I10)') 'MAXIMUM WITHDRAWAL/RETURN SERIES (NQWRM): ',NQWRM
  WRITE(888,'(A,I10)') 'MAXIMUM MTIDE CONSITIUENTS (MTM): ',MTM
  WRITE(888,'(A,I10)') 'NUMBER OF OPEN BOUNDARY CELLS: SOUTH (NPBS): ',NPBS
  WRITE(888,'(A,I10)') 'NUMBER OF OPEN BOUNDARY CELLS: WEST  (NPBW): ',NPBW
  WRITE(888,'(A,I10)') 'NUMBER OF OPEN BOUNDARY CELLS: EAST  (NPBE): ',NPBE
  WRITE(888,'(A,I10)') 'NUMBER OF OPEN BOUNDARY CELLS: NORTH (NPBN): ',NPBN
  WRITE(888,'(A,I10)')
  WRITE(888,'(A,I10)') 'NUMBER OF 3D FIELD OUTPUT UNSTRETCHED LAYERS (KPCM): ',KPCM
  WRITE(888,'(A,I10)') 'NUMBER OF PRESSURE CONTROLLED WITHDRAWAL/RETURN PAIRS (NQCTTM): ',NQCTTM
  WRITE(888,'(A,I10)')
  WRITE(888,'(A,I10)') 'NUMBER OF GROUNDWATER SERIES (NGWSERM): ',NGWSERM
  WRITE(888,'(A,I10)') 'MAXIMUM NUMBER OF POINTS IN GROUNDWATER SERIES (NDGWSER): ',NDGWSER
  WRITE(888,'(A,I10)')

  WRITE(888,'(A,I10)') 'NUMBER (NQCTTM): ',NQCTTM
  WRITE(888,'(A,I10)') 'NUMBER (KSM): ',KSM

  ! ***
  CLOSE(888)
  
  NMAXBC = MDCHH*2+NQSIJ+NQCTL*2+NQWR*2+NPBS+NPBW+NPBE+NPBN+NQJPIJ*2
  
  ALLOCATE(AAU(LCM))
  ALLOCATE(AAV(LCM))
  ALLOCATE(AB(LCM,KSM))
  ALLOCATE(ACCWX(MTM))
  ALLOCATE(AGWELV(LCM))           ! *** GROUNDWATER INTERACTION WITH CELL WATER ELEVATION (M) IF ISGWIE >= 1
  ALLOCATE(AGWELV1(LCM))
  ALLOCATE(AGWELV2(LCM))
  ALLOCATE(AH(LCM,KCM))
  ALLOCATE(AHC(LCM,KCM))
  ALLOCATE(AHDXY(LCM))
  ALLOCATE(AHOXY(LCM))
  ALLOCATE(AHU(LCM,KCM))          ! *** NOT USED - CAN BE USED FOR DEBUGGING
  ALLOCATE(AHV(LCM,KCM))          ! *** NOT USED - CAN BE USED FOR DEBUGGING
  ALLOCATE(ANGWRMFD(NQWRM))
  ALLOCATE(AP(KPCM))
  ALLOCATE(APCG(LCM))
  ALLOCATE(APT(KPCM,KCM))
  ALLOCATE(AQ(LCM,KCM))
  ALLOCATE(AQCTL(NQCTTM))
  ALLOCATE(ASURFEL(LCM))
  ALLOCATE(ATMP(LCM))
  ALLOCATE(AV(LCM,KSM))
  ALLOCATE(AVOXY(LCM))
  ALLOCATE(AVBXY(LCM))
  ALLOCATE(AVUI(LCM,KSM))
  ALLOCATE(AVVI(LCM,KSM))
  ALLOCATE(B(LCM,KCM))
  ALLOCATE(B0(KCM,MLM))
  ALLOCATE(B1(LCM,KCM))
  ALLOCATE(B1DT1(KCM,MLM))
  ALLOCATE(BBU(LCM))
  ALLOCATE(BBV(LCM))
  ALLOCATE(BCLSHA(KCM,MLM,MTM))
  ALLOCATE(BELAGW(LCM))
  ALLOCATE(BELSURF(LCM))
  ALLOCATE(BELV(LCM))
  ALLOCATE(BELV0(LCM))
  ALLOCATE(BELV1(LCM))
  ALLOCATE(BLSHA(KCM,MLM))
  ALLOCATE(BQCLCE(NQCTLM))
  ALLOCATE(BQWRMFD(NQWRM))
  ALLOCATE(BQWRMFU(NQWRM))
  ALLOCATE(BSLSHA(KCM,MLM,MTM))
  ALLOCATE(BTLSHA(KCM,MLM))
  ALLOCATE(BTMP(KCM))
  ALLOCATE(CAC(LCM,KCM))
  ALLOCATE(CBE(NBBEM,2,NSTVM))
  ALLOCATE(CBN(NBBNM,2,NSTVM))
  ALLOCATE(CBS(NBBSM,2,NSTVM))
  ALLOCATE(CBW(NBBWM,2,NSTVM))
  ALLOCATE(CC(LCM))
  ALLOCATE(CCC(LCM))
  ALLOCATE(CCCC(MTM))
  ALLOCATE(CCCCHH(NCHANM))
  ALLOCATE(CCCCHU(NCHANM))
  ALLOCATE(CCCCHV(NCHANM))
  ALLOCATE(CCCI(LCM))
  ALLOCATE(CCCOS(MTM))
  ALLOCATE(CCCOS1(MTM))
  ALLOCATE(CCE(LCM))
  ALLOCATE(CCI(LCM))
  ALLOCATE(CCLSHA(MTM,MTM))
  ALLOCATE(CCN(LCM))
  ALLOCATE(CCNHTT(LCM))                           ! *** WIND FUNCTION FOR CONDUCTIVE HEAT TRANSFER
  ALLOCATE(CCS(LCM))
  ALLOCATE(CCW(LCM))
  ALLOCATE(CDZKK(LCM,KCM))
  ALLOCATE(CDZKKP(LCM,KCM))
  ALLOCATE(CDZKMK(LCM,KCM))
  ALLOCATE(CE(LCM))
  ALLOCATE(CFRD(NQJPM))
  ALLOCATE(CHANFRIC(NCHANM))
  ALLOCATE(CHANLEN(NCHANM))
  ALLOCATE(CLEVAP(LCM))              ! *** WIND FUNCTION FOR EVAPORATION CALCULATIONS
  ALLOCATE(CLOE(NBBEM,KCM,NSTVM))
  ALLOCATE(CLON(NBBNM,KCM,NSTVM))
  ALLOCATE(CLOS(NBBSM,KCM,NSTVM))
  ALLOCATE(CLOUDT(LCM))
  ALLOCATE(CLOW(NBBWM,KCM,NSTVM))
  ALLOCATE(CLSHA(MTM))
  ALLOCATE(CLSL(MLM))
  ALLOCATE(CLTMSR(MLTMSRM))
  ALLOCATE(CMB(KCM))
  ALLOCATE(CN(LCM))
  ALLOCATE(CONGW(LCM,NSTVM))
  ALLOCATE(CONT(LCM,KCM))
  ALLOCATE(CPFAM0(NPFORM,MTM))
  ALLOCATE(CPFAM1(NPFORM,MTM))
  ALLOCATE(CPFAM2(NPFORM,MTM))
  ALLOCATE(CQCJP(KCM,NQJPM,NSTVM))
  ALLOCATE(CQS(KCM,NQSIJM,NSTVM))
  ALLOCATE(CQSE(NSTVM))
  ALLOCATE(CQWR(NQWRM,NSTVM))
  ALLOCATE(CQWRSER(NDQWRSR,NQWRSRM,NSTVM))
  ALLOCATE(CQWRSERT(0:NQWRSRM,NSTVM))
  ALLOCATE(CS(LCM))
  ALLOCATE(CSERT(KCM,0:NCSERM,NSTVM))
  ALLOCATE(CSLSHA(MTM,MTM))
  ALLOCATE(CTAUC(LCM))
  ALLOCATE(CTLSHA(MTM))
  ALLOCATE(CTURBB1(LCM,KCM))
  ALLOCATE(CTURBB2(LCM,KCM))
  ALLOCATE(CU1(LCM,KCM))
  ALLOCATE(CU2(LCM,KCM))
  ALLOCATE(CUE(LCM))
  ALLOCATE(CUN(LCM))
  ALLOCATE(CUU(LCM))
  ALLOCATE(CVE(LCM))
  ALLOCATE(CVN(LCM))
  ALLOCATE(CVV(LCM))
  ALLOCATE(CW(LCM))
  ALLOCATE(CWRCJP(NQJPM,NSTVM))
  ALLOCATE(DJET(NQJPM))
  ALLOCATE(DJPER(NQJPM))
  ALLOCATE(DLAT(LCM))
  ALLOCATE(DLON(LCM))
  ALLOCATE(DML(LCM,0:KCM))
  ALLOCATE(DTAUC(NTSM))
  ALLOCATE(DU(LCM,KCM))
  ALLOCATE(DV(LCM,KCM))
  ALLOCATE(DXDJ(LCM))
  ALLOCATE(DXFP(LCM))
  ALLOCATE(DXIU(LCM))
  ALLOCATE(DXIV(LCM))
  ALLOCATE(DXP(LCM))
  ALLOCATE(DXU(LCM))
  ALLOCATE(DXV(LCM))
  ALLOCATE(DXXTCA(LCM))
  ALLOCATE(DXYIP(LCM))
  ALLOCATE(DXYIU(LCM))
  ALLOCATE(DXYIV(LCM))
  ALLOCATE(DXYP(LCM))
  ALLOCATE(DXYTCA(LCM))
  ALLOCATE(DXYU(LCM))
  ALLOCATE(DXYV(LCM))
  ALLOCATE(DYDI(LCM))
  ALLOCATE(DYE(LCM,KCM))
  ALLOCATE(DYE1(LCM,KCM))
  ALLOCATE(DYEAD(KCM,1))
  ALLOCATE(DYEINIT(LCM,KCM))
  ALLOCATE(DYFP(LCM))
  ALLOCATE(DYIU(LCM))
  ALLOCATE(DYIV(LCM))
  ALLOCATE(DYP(LCM))
  ALLOCATE(DYU(LCM))
  ALLOCATE(DYV(LCM))
  ALLOCATE(DZIC(LCM,0:KCM))
  ALLOCATE(DZIG(LCM,0:KCM))
  ALLOCATE(EVAPGW(LCM))               ! *** TRANSPIRATION RATE OF WATER PER CELL (M3/S)
  ALLOCATE(EVAPSW(LCM))               ! *** EVAPORATION RATE OF WATER PER CELL (M3/S)
  ALLOCATE(EVAPT(LCM))                ! *** EVAPORATION RATE OF WATER PER CELL (M/S)
  ALLOCATE(FACBEDL(LCM))
  ALLOCATE(FACSUSL(LCM))
  ALLOCATE(FBBX(LCM,KCM))
  ALLOCATE(FBBY(LCM,KCM))
  IF( ISBODYF == 1 )THEN
    ALLOCATE(FBODYFX(LCM,KCM))
    ALLOCATE(FBODYFY(LCM,KCM))
  ENDIF
  ALLOCATE(FCAX(LCM,KCM))
  ALLOCATE(FCAXE(LCM))
  ALLOCATE(FCAY(LCM,KCM))
  ALLOCATE(FCAY1(LCM,KCM))
  ALLOCATE(FCAY1E(LCM))
  ALLOCATE(FCAYE(LCM))
  ALLOCATE(FCORC(LCM))
  ALLOCATE(FP(LCM))
  ALLOCATE(FP1(LCM))
  ALLOCATE(FPGXE(LCM))
  ALLOCATE(FPGYE(LCM))
  ALLOCATE(PMCTESTX(10,LCM))   ! *** CREATED AND ALLOCATED FOR DEBUG ASSIGNMENTS - NOT USED FOR ROUTINE RUNS
  !ALLOCATE(PMCTESTY(10,LCM))   ! *** CREATED AND ALLOCATED FOR DEBUG ASSIGNMENTS - NOT USED FOR ROUTINE RUNS
  ALLOCATE(FPROX(LCM,0:KCM))
  ALLOCATE(FPTMP(LCM))
  ALLOCATE(FSCORTBCV(LCM))
  ALLOCATE(FUDISP(KCM,LCM))
  ALLOCATE(FUHDYE(LCM))
  ALLOCATE(FUHU(LCM,KCM))
  ALLOCATE(FUHV(LCM,KCM))
  ALLOCATE(FVHDXE(LCM))
  ALLOCATE(FVHU(LCM,KCM))
  ALLOCATE(FVHV(LCM,KCM))
  ALLOCATE(FWQQ(LCM,KCM))
  ALLOCATE(FWQQL(LCM,KCM))
  ALLOCATE(FWU(LCM,0:KCM))
  ALLOCATE(FWV(LCM,0:KCM))
  ALLOCATE(FX(LCM,KCM))
  ALLOCATE(FXE(LCM))
  ALLOCATE(FY(LCM,KCM))
  ALLOCATE(FYE(LCM))
  ALLOCATE(FZU(0:KCM))
  ALLOCATE(FZV(0:KCM))
  ALLOCATE(GAMB(KCM))
  ALLOCATE(GLSHA(MGM,MGM))
  ALLOCATE(GWCSER(NDGWSER,NGWSERM,NSTVM))
  ALLOCATE(GWCSERT(0:NGWSERM,NSTVM))
  ALLOCATE(GWFAC(LCM))
  ALLOCATE(GWSER(NDGWSER,NGWSERM))
  ALLOCATE(GWSERT(0:NGWSERM))
  ALLOCATE(H1P(LCM))
  ALLOCATE(H1U(LCM))
  ALLOCATE(H1UI(LCM))
  ALLOCATE(H1V(LCM))
  ALLOCATE(H1VI(LCM))
  ALLOCATE(H2P(LCM))
  ALLOCATE(H2WQ(LCM))
  ALLOCATE(HBEDA(LCM))
  ALLOCATE(HBEDA1(LCM))
  ALLOCATE(HCTLDA(NQCTTM))
  ALLOCATE(HCTLDM(NQCTTM))
  ALLOCATE(HCTLUA(NQCTTM))
  ALLOCATE(HCTLUM(NQCTTM))
  ALLOCATE(HDFUFX(LCM))
  ALLOCATE(HDFUFY(LCM))
  ALLOCATE(HDFUF(LCM))
  ALLOCATE(HDIFCTD(NDQCLT,NQCTTM))
  ALLOCATE(HDIFCTL(NDQCLT,NQCTTM))
  ALLOCATE(HGDH(LCM))
  ALLOCATE(HMP(LCM))
  ALLOCATE(HMPW(LCM))
  ALLOCATE(HMU(LCM))
  ALLOCATE(HMUW(LCM))
  ALLOCATE(HMV(LCM))
  ALLOCATE(HMVW(LCM))
  ALLOCATE(HP(LCM))
  ALLOCATE(HPI(LCM))
  ALLOCATE(HPTMP(LCM))
  ALLOCATE(HRU(LCM))
  ALLOCATE(HRUO(LCM))            ! *** U INTERFACE METRIC (DY AT THE U FACE) / (DX AT THE U FACE) [DYU(L)*DXIU(L)] (DIMENSIONLESS)
  ALLOCATE(HRV(LCM))
  ALLOCATE(HRVO(LCM))            ! *** V INTERFACE METRIC (DX AT THE V FACE) / (DY AT THE V FACE) [DXV(L)*DYIV(L)] (DIMENSIONLESS)
  ALLOCATE(HTMP(LCM))
  ALLOCATE(HU(LCM))
  ALLOCATE(HUDRY(LCM))
  ALLOCATE(HUI(LCM))
  ALLOCATE(HUTMP(LCM))
  ALLOCATE(HUWET(LCM))
  ALLOCATE(HV(LCM))
  ALLOCATE(HVDRY(LCM))
  ALLOCATE(HVI(LCM))
  ALLOCATE(HVTMP(LCM))
  ALLOCATE(HVWET(LCM))
  ALLOCATE(HWQ(LCM))
  ALLOCATE(HWQI(LCM))
  ALLOCATE(IACTLR(NGLM))
  ALLOCATE(IAIJ(IGM,JGM))
  ALLOCATE(IAKL(KPCM,LCM))
  ALLOCATE(IAP(KPCM))
  ALLOCATE(ICALJP(NQJPM))
  ALLOCATE(ICBE(NBBEM))
  ALLOCATE(ICBN(NBBNM))
  ALLOCATE(ICBS(NBBSM))
  ALLOCATE(ICBW(NBBWM))
  ALLOCATE(ICCDA(NLDAM))
  ALLOCATE(ICDA(NLDAM))
  ALLOCATE(ICFLMP(LCM))
  ALLOCATE(ICSMTS(NTSSMVM,NSMTSM))
  ALLOCATE(IEPEW(NPEWBP))
  ALLOCATE(IGWSER(NGWSERM))
  ALLOCATE(IJCT(ICM,JCM))
  ALLOCATE(IJCTLT(ICM,JCM))
  ALLOCATE(IL(LCM))
  ALLOCATE(ILLSHA(MLM))
  ALLOCATE(ILLT(LCM))
  ALLOCATE(ILTMSR(MLTMSRM))
  !ALLOCATE(IMASKDRY(LCM))        ! *** DEPRECATED - NO LONGER USED 2015-02
  ALLOCATE(IMDCHH(NCHANM))
  ALLOCATE(IMDCHU(NCHANM))
  ALLOCATE(IMDCHV(NCHANM))
  ALLOCATE(INPNS(NPNSBP))
  ALLOCATE(INTPSER(NPSERM))
  ALLOCATE(IOUTJP(NQJPM))
  ALLOCATE(IPART(LCM))
  ALLOCATE(IPBE(NPBEM))
  ALLOCATE(IPBN(NPBNM))
  ALLOCATE(IPBS(NPBSM))
  ALLOCATE(IPBW(NPBWM))
  ALLOCATE(IQCAX(NQCTLM))
  ALLOCATE(IQCTLD(NQCTLM))
  ALLOCATE(IQCTLU(NQCTLM))
  ALLOCATE(IQJP(NQJPM))
  ALLOCATE(IQS(NQSIJM))
  ALLOCATE(IQWRD(NQWRM))
  ALLOCATE(IQWRU(NQWRM))
  ALLOCATE(ISCDRY(LCM))
  ALLOCATE(ISDJP(NQJPM))
  ALLOCATE(ISENT(NQJPM))
  ALLOCATE(ISPBE(NPBEM))
  ALLOCATE(ISPBN(NPBNM))
  ALLOCATE(ISPBS(NPBSM))
  ALLOCATE(ISPBW(NPBWM))
  ALLOCATE(ISPNS(NPNSBP))
  ALLOCATE(ISSBCP(LCM))
  ALLOCATE(ISTJP(NQJPM))
  ALLOCATE(ISUDPC(NCHANM))
  ALLOCATE(ITPCDA(NLDAM))
  ALLOCATE(IUPCJP(NQJPM))
  ALLOCATE(IWPEW(NPEWBP))
  ALLOCATE(IWGG(NWGGM))
  ALLOCATE(JCBE(NBBEM))
  ALLOCATE(JCBN(NBBNM))
  ALLOCATE(JCBS(NBBSM))
  ALLOCATE(JCBW(NBBWM))
  ALLOCATE(JCCDA(NLDAM))
  ALLOCATE(JCDA(NLDAM))
  ALLOCATE(JEPEW(NPEWBP))
  ALLOCATE(JL(LCM))
  ALLOCATE(JLLSHA(MLM))
  ALLOCATE(JLLT(LCM))
  ALLOCATE(JLTMSR(MLTMSRM))
  ALLOCATE(JMDCHH(NCHANM))
  ALLOCATE(JMDCHU(NCHANM))
  ALLOCATE(JMDCHV(NCHANM))
  ALLOCATE(JNPNS(NPNSBP))
  ALLOCATE(JPBE(NPBEM))
  ALLOCATE(JPBN(NPBNM))
  ALLOCATE(JPBS(NPBSM))
  ALLOCATE(JPBW(NPBWM))
  ALLOCATE(JQCAX(NQCTLM))
  ALLOCATE(JQCTLD(NQCTLM))
  ALLOCATE(JQCTLU(NQCTLM))
  ALLOCATE(JQJP(NQJPM))
  ALLOCATE(JQS(NQSIJM))
  ALLOCATE(JQWRD(NQWRM))
  ALLOCATE(JQWRU(NQWRM))
  ALLOCATE(JSPNS(NPNSBP))
  ALLOCATE(JUPCJP(NQJPM))
  ALLOCATE(JWPEW(NPEWBP))
  ALLOCATE(JWGG(NWGGM))
  ALLOCATE(JWQCBE(NBBEM))
  ALLOCATE(JWQCBN(NBBNM))
  ALLOCATE(JWQCBS(NBBSM))
  ALLOCATE(JWQCBW(NBBWM))
  ALLOCATE(KBT(LCM))
  ALLOCATE(KCEFDC(LCM*KCM))
  ALLOCATE(KEFFJP(NQJPM))
  ALLOCATE(KFEFDC(2*LCM*KCM))
  ALLOCATE(KPS(LCM))
  ALLOCATE(KQJP(NQJPM))
  ALLOCATE(KQWRD(NQWRM))
  ALLOCATE(KQWRU(NQWRM))
  ALLOCATE(KUPCJP(NQJPM))
  ALLOCATE(KUPW(LCM,KCM))
  ALLOCATE(LBERC(NMAXBC))
  ALLOCATE(LBNRC(NMAXBC))
  ALLOCATE(LBSRC(NMAXBC))
  ALLOCATE(LBWRC(NMAXBC))
  ALLOCATE(LCBE(NBBEM))
  ALLOCATE(LCBN(NBBNM))
  ALLOCATE(LCBS(NBBSM))
  ALLOCATE(LCBW(NBBWM))
  ALLOCATE(LCDA(NLDAM))
  ALLOCATE(LCONSOL(LCM))
  ALLOCATE(LCT(LCM))
  ALLOCATE(LCTLT(LCM))
  ALLOCATE(LEC(LCM))
  ALLOCATE(LECLT(LCM))
  ALLOCATE(LIJ(ICM,JCM))
  ALLOCATE(LIJLT(ICM,JCM))
  ALLOCATE(LJUNX(NJUNXM))
  ALLOCATE(LJUNY(NJUNYM))
  ALLOCATE(LLBC(LCM))
  ALLOCATE(LLRC(LCM))
  ALLOCATE(LLSHA(MLM))
  ALLOCATE(LMASKDRY(LCM))
  ALLOCATE(LWVMASK(LCM))
  ALLOCATE(LMDCHH(NCHANM))
  ALLOCATE(LMDCHU(NCHANM))
  ALLOCATE(LMDCHV(NCHANM))
  ALLOCATE(LOPENBCDRY(LCM))
  ALLOCATE(LNC(LCM))
  ALLOCATE(LNCLT(LCM))
  ALLOCATE(LNEC(LCM))
  ALLOCATE(LNWC(LCM))
  ALLOCATE(LOBCS(LCM))
  ALLOCATE(LOBCS2(LCM))
  ALLOCATE(LBCS(NMAXBC))
  ALLOCATE(LORDER(LCM))
  ALLOCATE(LPBE(NPBEM))
  ALLOCATE(LPBN(NPBNM))
  ALLOCATE(LPBS(NPBSM))
  ALLOCATE(LPBW(NPBWM))
  ALLOCATE(LQCTLD(NQCTLM))
  ALLOCATE(LQCTLU(NQCTLM))
  ALLOCATE(LQS(NQSIJM))
  ALLOCATE(LQWRD(NQWRM))
  ALLOCATE(LQWRU(NQWRM))
  ALLOCATE(LSBLBCD(LCM))
  ALLOCATE(LSBLBCU(LCM))
  ALLOCATE(LSC(LCM))
  ALLOCATE(LSCLT(LCM))
  ALLOCATE(LSEC(LCM))
  ALLOCATE(LSHAB(MLM))
  ALLOCATE(LSHAP(MLM))
  ALLOCATE(LSHAU(MLM))
  ALLOCATE(LSHAUE(MLM))
  ALLOCATE(LSMTS(NSMTSM))
  ALLOCATE(LSWC(LCM))
  ALLOCATE(LUPU(LCM,KCM))
  ALLOCATE(LUPV(LCM,KCM))
  ALLOCATE(LWC(LCM))
  ALLOCATE(LWCLT(LCM))
  ALLOCATE(LWGG(NWGGM))
  ALLOCATE(LWVCELL(LCM))
  ALLOCATE(MCNTLR(NGLM))
  ALLOCATE(MCSER(NCSERM,NSTVM))
  ALLOCATE(MCTLAST(NCSERM,NSTVM))
  ALLOCATE(MFDCHZ(LCM))
  ALLOCATE(MDCHTYP(NCHANM))
  ALLOCATE(MGWSER(NGWSERM))
  ALLOCATE(MGWTLAST(NGWSERM))
  ALLOCATE(MPSER(NPSERM))
  ALLOCATE(MPTLAST(NPSERM))
  ALLOCATE(MQCTL(NQCTTM))
  ALLOCATE(MQSER(NQSERM))
  ALLOCATE(MQTLAST(NQSERM))
  ALLOCATE(MQWRSR(NQWRSRM))
  ALLOCATE(MQWRTLST(NQWRSRM))
  ALLOCATE(MTMSRA(MLTMSRM))
  ALLOCATE(MTMSRC(MLTMSRM))
  ALLOCATE(MTMSRP(MLTMSRM))
  ALLOCATE(MTMSRQ(MLTMSRM))
  ALLOCATE(MTMSRQE(MLTMSRM))
  ALLOCATE(MTMSRU(MLTMSRM))
  ALLOCATE(MTMSRUE(MLTMSRM))
  ALLOCATE(MTMSRUT(MLTMSRM))
  ALLOCATE(MTSCUR(NTSSTSPM))
  ALLOCATE(MTSSTSP(NTSSTSPM))
  ALLOCATE(MVEGL(LCM))
  ALLOCATE(MVEGSER(NVEGSERM))
  ALLOCATE(MVEGTLAST(NVEGSERM))
  ALLOCATE(NATDRY(LCM))
  ALLOCATE(NCSER(NSTVM))
  ALLOCATE(NCSERA(NLDAM,NSTVM))
  ALLOCATE(NCSERE(NBBEM,NSTVM))
  ALLOCATE(NCSERJP(NQJPM,NSTVM))
  ALLOCATE(NCSERN(NBBNM,NSTVM))
  ALLOCATE(NCSERQ(NQSIJM,NSTVM))
  ALLOCATE(NCSERS(NBBSM,NSTVM))
  ALLOCATE(NCSERW(NBBWM,NSTVM))
  ALLOCATE(NDRY(LCM))
  ALLOCATE(NGWSL(LCM))
  ALLOCATE(NJEL(NQJPM))
  ALLOCATE(NJPMX(NQJPM))
  ALLOCATE(NLOE(NBBEM,KCM,NSTVM))
  ALLOCATE(NLON(NBBNM,KCM,NSTVM))
  ALLOCATE(NLOS(NBBSM,KCM,NSTVM))
  ALLOCATE(NLOW(NBBWM,KCM,NSTVM))
  ALLOCATE(NLRPDRT(NGLM))
  ALLOCATE(NPORTJP(NQJPM))
  ALLOCATE(NPSERE(NPBEM))
  ALLOCATE(NPSERN(NPBNM))
  ALLOCATE(NPSERS(NPBSM))
  ALLOCATE(NPSERW(NPBWM))
  ALLOCATE(NPSERE1(NPBEM))
  ALLOCATE(NPSERN1(NPBNM))
  ALLOCATE(NPSERS1(NPBSM))
  ALLOCATE(NPSERW1(NPBWM))
  ALLOCATE(NQCMINS(NQCTLM))
  ALLOCATE(NQCMUL(NQCTLM))
  ALLOCATE(NQCTLQ(NQCTLM))
  ALLOCATE(NQCTYP(NQCTLM))
  ALLOCATE(NQSERJP(NQJPM))
  ALLOCATE(NQSERQ(NQSIJM))
  ALLOCATE(NQSMF(NQSIJM))
  ALLOCATE(NQSMUL(NQSIJM))
  ALLOCATE(NQWRMFD(NQWRM))
  ALLOCATE(NQWRMFU(NQWRM))
  ALLOCATE(NQWRSERJP(NQJPM))
  ALLOCATE(NQWRSERQ(NQWRM))
  ALLOCATE(NTSCRE(NBBEM))
  ALLOCATE(NTSCRN(NBBNM))
  ALLOCATE(NTSCRS(NBBSM))
  ALLOCATE(NTSCRW(NBBWM))
  ALLOCATE(NTSSSS(MLTMSRM))
  ALLOCATE(NTVSFP(MTVSM))
  ALLOCATE(NUDJP(NQJPM))
  ALLOCATE(NUDJPC(NQJPM))
  ALLOCATE(NXYSDAT(LCM))
  ALLOCATE(NZPRJP(NQJPM))
  ALLOCATE(OLDMASK(LCM))  
  ALLOCATE(P(LCM))
  ALLOCATE(P1(LCM))
  ALLOCATE(P1DT1(MLM))
  ALLOCATE(PATMT(LCM))
  ALLOCATE(PCBE(NPBEM,MTM))
  ALLOCATE(PCBN(NPBNM,MTM))
  ALLOCATE(PCBS(NPBSM,MTM))
  ALLOCATE(PCBW(NPBWM,MTM))
  ALLOCATE(PCLSHA(MLM,MTM))
  ALLOCATE(PSERZDF(0:NPSERM))
  ALLOCATE(PSERZDS(0:NPSERM))
  ALLOCATE(PFAM(NPFORM,MTM))
  ALLOCATE(PFAM1(NPFORM,MTM))
  ALLOCATE(PFAM2(NPFORM,MTM))
  ALLOCATE(PFPH(NPFORM,MTM))
  ALLOCATE(PFPH1(NPFORM,MTM))
  ALLOCATE(PFPH2(NPFORM,MTM))
  ALLOCATE(PHASEE(MTM))
  ALLOCATE(PHASEU(MTM))
  ALLOCATE(PHASEV(MTM))
  ALLOCATE(PHJET(NQJPM))
  ALLOCATE(PLSHA(MLM))
  ALLOCATE(PMDCH(NCHANM))
  ALLOCATE(PNHYDS(LCM,KCM))
  ALLOCATE(PPH(LCM))
  ALLOCATE(PSBE(NPBEM,MTM))
  ALLOCATE(PSBN(NPBNM,MTM))
  ALLOCATE(PSBS(NPBSM,MTM))
  ALLOCATE(PSBW(NPBWM,MTM))
  ALLOCATE(PSER(NDPSER,NPSERM))
  ALLOCATE(PSERS(NDPSER,NPSERM))
  ALLOCATE(PSERT(0:NPSERM))
  ALLOCATE(PSERST(0:NPSERM))
  ALLOCATE(PSHADE(LCM))
  ALLOCATE(PSLSHA(MLM,MTM))
  ALLOCATE(PTLSHA(MLM))
  ALLOCATE(PTMP(LCM))
  ALLOCATE(QCELLCTR(LCM))
  ALLOCATE(QCHANU(NCHANM))
  ALLOCATE(QCHANUN(NCHANM))
  ALLOCATE(QCHANV(NCHANM))
  ALLOCATE(QCHANVN(NCHANM))
  ALLOCATE(QCHNULP(NCHANM))
  ALLOCATE(QCHNVLP(NCHANM))
  ALLOCATE(QCTL(NDQCLT,NDQCLT2,KCM,NQCTTM))
  ALLOCATE(QCTLST(KCM,NQCTLM))
  ALLOCATE(QCTLSTO(KCM,NQCTLM))
  ALLOCATE(QCTLT(KCM,0:NQCTLM,2))
  ALLOCATE(QCTLTLP(KCM,NQCTLM))
  ALLOCATE(QCTLTO(KCM,0:NQCTLM))
  ALLOCATE(QCTLGRP(NQCTLM))
  ALLOCATE(QCTLMU(NQCTLM))
  ALLOCATE(QDWASTE(LCM))
  ALLOCATE(QFACTOR(NQSIJM))
  ALLOCATE(QGW(LCM))                              ! *** GROUNDWATER FLUX TERM (M^3/S), 2018-10-24 PMC CHANGED SIGN CONVENTION FOR SEEPAGE +(IN), -(OUT) 
  ALLOCATE(QJPENT(KCM,NQJPM))
  ALLOCATE(QJPENTT(NQJPM))
  ALLOCATE(QMORPH(LCM))
  ALLOCATE(QQ(LCM,0:KCM))
  ALLOCATE(QQ1(LCM,0:KCM))
  ALLOCATE(QQ2(LCM,0:KCM))
  ALLOCATE(QQSQR(LCM,0:KCM))
  ALLOCATE(QQCJP(NQJPM))
  ALLOCATE(QQL(LCM,0:KCM))
  ALLOCATE(QQL1(LCM,0:KCM))
  ALLOCATE(QQL2(LCM,0:KCM))
  ALLOCATE(QQWC(LCM))
  ALLOCATE(QQWCR(LCM))
  ALLOCATE(QQWV1(LCM))
  ALLOCATE(QQWV2(LCM))
  ALLOCATE(QQWV3(LCM))
  ALLOCATE(QRAIN(LCM))
  ALLOCATE(QSERT(KCM,0:NQSERM))
  ALLOCATE(QSERCELL(KCM,0:NQSIJM))
  ALLOCATE(QSRTLPN(KCM,NQSERM))
  ALLOCATE(QSRTLPP(KCM,NQSERM))
  ALLOCATE(QSS(KCM,NQSIJM))
  ALLOCATE(QSSDPA(LCM))
  ALLOCATE(QSUM(LCM,KCM))
  ALLOCATE(QSUME(LCM))
  ALLOCATE(QSUM1E(LCM))
  ALLOCATE(QWATPA(LCM))
  ALLOCATE(QWBDTOP(LCM))
  ALLOCATE(QWIDTH(NQSIJM))
  ALLOCATE(QWR(NQWRM))
  ALLOCATE(QWRCJP(NQJPM))
  ALLOCATE(QWRSER(NDQWRSR,NQWRSRM))
  ALLOCATE(QWRSERT(0:NQWRSRM))
  ALLOCATE(QWRSERTLP(0:NQWRSRM))
  ALLOCATE(RADBOT(LCM,KCM))              ! *** SOLAR RADIATION AT THE BOTTOM OF THE LAYER  (W/M2)
  ALLOCATE(RADNET(LCM,KCM))              ! *** NET SOLAR RADIATION AT THE MIDPOINT OF THE LAYER (W/M2)
  ALLOCATE(RADTOP(LCM,0:KCM))            ! *** SOLAR RADIATION AT THE TOP OF THE LAYER (W/M2)
  ALLOCATE(RADKE (LCM,KCM))              ! *** EXTINCTION COEFFICIENT AT THE MIDPOINT OF THE LAYER
  ALLOCATE(RAINT(LCM))                   ! *** CURRENT RAINFALL PER CELL (M/S)
  ALLOCATE(RBPSBL(LCM))
  ALLOCATE(RCX(LCM))
  ALLOCATE(RCY(LCM))
  ALLOCATE(RHAT(LCM))
  ALLOCATE(RHS(MGM))
  ALLOCATE(RI(NPDM))
  ALLOCATE(RJ(NPDM))
  ALLOCATE(RK(NPDM))
  ALLOCATE(RMAJ(MTM))
  ALLOCATE(RMIN(MTM))
  ALLOCATE(ROUSE(LCM))
  ALLOCATE(RQCMUL(NQCTLM))
  ALLOCATE(RQSMUL(NQSIJM))
  ALLOCATE(RSOL(MGM))
  ALLOCATE(RSSBCE(LCM))
  ALLOCATE(RSSBCN(LCM))
  ALLOCATE(RSSBCS(LCM))
  ALLOCATE(RSSBCW(LCM))
  ALLOCATE(SAAX(0:LCM))
  ALLOCATE(SAAY(0:LCM))
  ALLOCATE(SAL(LCM,KCM))
  ALLOCATE(SAL1(LCM,KCM))
  ALLOCATE(SALAD(KCM,1))
  ALLOCATE(SALINIT(LCM,KCM))
  ALLOCATE(SBX(0:LCM))
  ALLOCATE(SBXO(0:LCM))
  ALLOCATE(SBY(0:LCM))
  ALLOCATE(SBYO(0:LCM))
  ALLOCATE(SCAX(0:LCM))
  ALLOCATE(SCAY(0:LCM))
  ALLOCATE(SCB(0:LCM))
  ALLOCATE(SCLSHA(MTM,MTM))
  ALLOCATE(SDX(0:LCM))
  ALLOCATE(SDY(0:LCM))
  
  ALLOCATE(SFL(LCM,KCM))
  ALLOCATE(SFL2(LCM,KCM))
  ALLOCATE(SFLAD(KCM,1))
  ALLOCATE(SFLINIT(LCM,KCM))
  ALLOCATE(SFLSBOT(LCM))
  
  ALLOCATE(SIGPHIA(LCM))
  ALLOCATE(SLSHA(MTM))
  ALLOCATE(SM1DIFT(NSMZM))
  ALLOCATE(SM2DIFT(NSMZM))
  ALLOCATE(SNAPSHOTS(5000))  ! *** PMC - Hardwired for now
  
  ALLOCATE(SOLFRD(NDASER))
  ALLOCATE(SOLSRD(NDASER))
  ALLOCATE(SOLSWRT(LCM))
  ALLOCATE(SPB(0:LCM))
  ALLOCATE(SPBE1(NPBEM))
  ALLOCATE(SPBE2(NPBEM))
  ALLOCATE(SPBN1(NPBNM))
  ALLOCATE(SPBN2(NPBNM))
  ALLOCATE(SPBS1(NPBSM))
  ALLOCATE(SPBS2(NPBSM))
  ALLOCATE(SPBW1(NPBWM))
  ALLOCATE(SPBW2(NPBWM))
  ALLOCATE(SPFAM0(NPFORM,MTM))
  ALLOCATE(SPFAM1(NPFORM,MTM))
  ALLOCATE(SPFAM2(NPFORM,MTM))
  ALLOCATE(SSLSHA(MTM,MTM))
  ALLOCATE(SSSIN(MTM))
  ALLOCATE(SSSIN1(MTM))
  ALLOCATE(SSSS(MTM))
  ALLOCATE(STBX(LCM))
  ALLOCATE(STBXO(LCM))
  ALLOCATE(STBY(LCM))
  ALLOCATE(STBYO(LCM))
  ALLOCATE(STCAP(LCM))
  ALLOCATE(STCUV(LCM))
  ALLOCATE(STLSHA(MTM))
  ALLOCATE(SUB(0:LCM))
  ALLOCATE(SUBO(0:LCM))
  ALLOCATE(UMASK(0:LCM))
  ALLOCATE(VMASK(0:LCM))
  ALLOCATE(SVB(0:LCM))
  ALLOCATE(SVBO(0:LCM))
  ALLOCATE(SVPAT(0:LCM))
  ALLOCATE(SVPW(0:LCM))
  ALLOCATE(SWB(0:LCM))
  ALLOCATE(SYMBOL(MTM))
  ALLOCATE(TACSER(NCSERM,NSTVM))
  ALLOCATE(TAGWSER(NGWSERM))
  ALLOCATE(TAPSER(NPSERM))
  ALLOCATE(TAQSER(NQSERM))
  ALLOCATE(TAQWRSR(NQWRSRM))
  ALLOCATE(TATMT(LCM))
  ALLOCATE(TAUB(LCM))
  ALLOCATE(TAVEGSER(NVEGSERM))
  ALLOCATE(TBX(LCM))
  ALLOCATE(TBX1(LCM))
  ALLOCATE(TBY(LCM))
  ALLOCATE(TBY1(LCM))
  ALLOCATE(TCCSER(NCSERM,NSTVM))
  ALLOCATE(TCGWSER(NGWSERM))
  ALLOCATE(TCP(MTM))
  ALLOCATE(TCPSER(NPSERM))
  ALLOCATE(TCQSER(NQSERM))
  ALLOCATE(TCQWRSR(NQWRSRM))
  ALLOCATE(TCVEGSER(NVEGSERM))
  ALLOCATE(TDEWT(LCM))
  ALLOCATE(TEM(LCM,KCM))
  ALLOCATE(TEM1(LCM,KCM))
  ALLOCATE(TEMAD(KCM,1))
  ALLOCATE(TEMB(LCM))
  ALLOCATE(TEMB1(LCM))
  ALLOCATE(TEMINIT(LCM,KCM))
  ALLOCATE(TGWSER(NDGWSER,NGWSERM))
  ALLOCATE(THJET(NQJPM))
  ALLOCATE(TMP3D(KCM))
  
  ALLOCATE(TPCOORDE(NPBEM))
  ALLOCATE(TPCOORDN(NPBNM))
  ALLOCATE(TPCOORDS(NPBSM))
  ALLOCATE(TPCOORDW(NPBWM))
  ALLOCATE(TPSER(NDPSER,NPSERM))
  ALLOCATE(TQWRSER(NDQWRSR,NQWRSRM))
  ALLOCATE(TSSRD(NDASER))
  ALLOCATE(TSSTOP(MTSSTSPM,NTSSTSPM))
  ALLOCATE(TSSTRT(MTSSTSPM,NTSSTSPM))
  ALLOCATE(TSX(LCM))
  ALLOCATE(TSX1(LCM))
  ALLOCATE(TSY(LCM))
  ALLOCATE(TSY1(LCM))
  ALLOCATE(TVAR1E(LCM,KCM))
  ALLOCATE(TVAR1N(LCM,KCM))
  ALLOCATE(TVAR1S(LCM,KCM))
  ALLOCATE(TVAR1W(LCM,KCM))
  ALLOCATE(TVAR2C(LCM,0:KCM))
  ALLOCATE(TVAR2E(LCM,KCM))
  ALLOCATE(TVAR2N(LCM,KCM))
  ALLOCATE(TVAR2S(LCM,KCM))
  ALLOCATE(TVAR2W(LCM,KCM))
  ALLOCATE(TVAR3C(LCM))
  ALLOCATE(TVAR3E(LCM))
  ALLOCATE(TVAR3N(LCM))
  ALLOCATE(TVAR3S(LCM))
  ALLOCATE(TVAR3W(LCM))
  ALLOCATE(TVEGSER(NDVEGSER,NVEGSERM))
  ALLOCATE(TWATER(LCM))  !BRW for outputing water temperature to tecp!lot
  ALLOCATE(U(LCM,KCM))
  ALLOCATE(U0(KCM,MLM))
  ALLOCATE(U1(LCM,KCM))
  ALLOCATE(U1V(LCM))
  ALLOCATE(U2(LCM,KCM))
  ALLOCATE(UAGD(KCM,1))
  ALLOCATE(UCELLCTR(LCM))
  ALLOCATE(UCLSHA(KCM,MLM,MTM))
  ALLOCATE(UCOS(MTM))
  ALLOCATE(UE0(MLM))
  ALLOCATE(UE1DT1(MLM))
  ALLOCATE(UECLSHA(MLM,MTM))
  ALLOCATE(UELSHA(MLM))
  ALLOCATE(UESLSHA(MLM,MTM))
  ALLOCATE(UETLSHA(MLM))
  ALLOCATE(UHDY1E(LCM))
  ALLOCATE(UHDY2E(LCM))
  ALLOCATE(UHDYE(LCM))
  ALLOCATE(UHDYEK(LCM,KCM))
  ALLOCATE(UHDY1EK(LCM,KCM))
  ALLOCATE(UHDY2EK(LCM,KCM))
  ALLOCATE(UHE(LCM))
  ALLOCATE(USIN(MTM))
  ALLOCATE(USLSHA(KCM,MLM,MTM))
  ALLOCATE(USTAR(LCM))
  ALLOCATE(USTARSED(LCM))
  ALLOCATE(USTARSND(LCM))
  ALLOCATE(UUU(LCM,KCM))
  ALLOCATE(UV(LCM))
  ALLOCATE(UWVSQ(LCM))
  ALLOCATE(V(LCM,KCM))
  ALLOCATE(V0(KCM,MLM))
  ALLOCATE(V1(LCM,KCM))
  ALLOCATE(V1U(LCM))
  ALLOCATE(V2(LCM,KCM))
  ALLOCATE(VAGD(KCM,1))
  ALLOCATE(VCELLCTR(LCM))
  ALLOCATE(VCLSHA(KCM,MLM,MTM))
  ALLOCATE(VCOS(MTM))
  ALLOCATE(VDWASTE(LCM))
  ALLOCATE(VE0(MLM))
  ALLOCATE(VE1DT1(MLM))
  ALLOCATE(VECLSHA(MLM,MTM))
  ALLOCATE(VEGK(LCM))
  ALLOCATE(VEGSERB(NDVEGSER,NVEGSERM))
  ALLOCATE(VEGSERBT(NVEGSERM))
  ALLOCATE(VEGSERH(NDVEGSER,NVEGSERM))
  ALLOCATE(VEGSERHT(NVEGSERM))
  ALLOCATE(VEGSERR(NDVEGSER,NVEGSERM))
  ALLOCATE(VEGSERRT(NVEGSERM))
  ALLOCATE(VELSHA(MLM))
  ALLOCATE(VESLSHA(MLM,MTM))
  ALLOCATE(VETLSHA(MLM))
  ALLOCATE(VHDX1E(LCM))
  ALLOCATE(VHDX2E(LCM))
  ALLOCATE(VHDXE(LCM))
  ALLOCATE(VHDXEK(LCM,KCM))
  ALLOCATE(VHDX1EK(LCM,KCM))
  ALLOCATE(VHDX2EK(LCM,KCM))
  ALLOCATE(VHE(LCM))
  ALLOCATE(VOLPERC(LCM))
  ALLOCATE(VOLSEL(LCM))
  ALLOCATE(VPAT(LCM))
  ALLOCATE(VSIN(MTM))
  ALLOCATE(VSLSHA(KCM,MLM,MTM))
  ALLOCATE(VU(LCM))
  ALLOCATE(VVLSHA(MGM,MGM))
  ALLOCATE(VVV(LCM,KCM))
  ALLOCATE(W(LCM,0:KCM))
  ALLOCATE(W1(LCM,0:KCM))
  ALLOCATE(W2(LCM,0:KCM))
  ALLOCATE(WACCWE(LCM))
  ALLOCATE(WAGD(KCM,1))
  ALLOCATE(WC(NTSM))
  ALLOCATE(WC2(NTSM))
  ALLOCATE(WCOREST(LCM))
  ALLOCATE(WCORWST(LCM))
  ALLOCATE(WCORNTH(LCM))
  ALLOCATE(WCORSTH(LCM))
  ALLOCATE(WINDCD10(LCM))            ! *** WIND DRAG COEFFICIENT FOR EACH CELL (NO DIM)
  ALLOCATE(WINDST(LCM))              ! *** WIND SPEED AT 2 METERS FOR EACH CELL (M/S)
  ALLOCATE(WINDSTKA(LCM))            ! *** WIND SHELTERING COEFFICIENT
  ALLOCATE(WINDSTKA_SAVE(LCM))
  ALLOCATE(WKQ(KCM))
  ALLOCATE(WLSHA(MGM))
  ALLOCATE(WNDVELE(LCM))
  ALLOCATE(WNDVELN(LCM))
  ALLOCATE(WTCI(KCM,2))
  ALLOCATE(WVDTKEM(KSM))
  ALLOCATE(WVDTKEP(KSM))
  ALLOCATE(WVENEP(LCM))
  ALLOCATE(WVHUU(LCM,KCM))
  ALLOCATE(WVHUV(LCM,KCM))
  ALLOCATE(WVHVV(LCM,KCM))
  ALLOCATE(WVKHC(LCM))
  ALLOCATE(WVKHU(LCM))
  ALLOCATE(WVKHV(LCM))
  ALLOCATE(WVPP(LCM,KCM))
  ALLOCATE(WVPT(LCM,0:KCM))
  ALLOCATE(WVPU(LCM,KCM))
  ALLOCATE(WVPV(LCM,KCM))
  ALLOCATE(WVTMP1(LCM))
  ALLOCATE(WVTMP2(LCM))
  ALLOCATE(WVTMP3(LCM))
  ALLOCATE(WVTMP4(LCM))
  
  ALLOCATE(WWW(LCM,0:KCM))
  ALLOCATE(XJETL(NQJPM))
  ALLOCATE(YJETL(NQJPM))
  
  ALLOCATE(Z(LCM,0:KCM))
  ALLOCATE(ZAD(KCM,1))
  ALLOCATE(ZBR(LCM))
  ALLOCATE(ZBRE(LCM))
  ALLOCATE(ZEQ(LCM))
  ALLOCATE(ZEQD(LCM))
  ALLOCATE(ZEQDI(LCM))
  ALLOCATE(ZEQI(LCM))
  ALLOCATE(ZETATOP(LCM))
  ALLOCATE(ZJET(NQJPM))
  ALLOCATE(ZP(0:KPCM))
  ALLOCATE(ZZ(LCM,0:KCM))
  ALLOCATE(ZZC(0:KCM,LCM))
  ALLOCATE(ZZP(KPCM))

  ! *** NEXT SECTION ALLOCATES USAGE DEPENDENT VARIABLES
  !IF( ISDRY > 0 ) ALLOCATE(TIMEDRY(LCM))
  
  IF( ISINWV == 1 .OR. ISNEGH > 0 )THEN
    ALLOCATE(CFLCAC(LCM,KCM))
    ALLOCATE(CFLUUU(LCM,KCM))
    ALLOCATE(CFLVVV(LCM,KCM))
    ALLOCATE(CFLWWW(LCM,0:KCM))
  ENDIF
  
  IF( ISVHEAT > 0 )THEN
    ALLOCATE(LSVHTWINDE(LCM))
    ALLOCATE(LSVHTWINDC(LCM))
    ALLOCATE(SVREVC(LCM))
    ALLOCATE(SVRCHC(LCM))
  ENDIF
  ALLOCATE(SVKEBACK(LCM))
  
  IF( ISDISP > 0 )THEN
    ALLOCATE(BDISP(KCM,KCM,LCM))
    ALLOCATE(CUDISPT(KCM,LCM))
    ALLOCATE(CVDISPT(KCM,LCM))
    ALLOCATE(DYXTCA(LCM))
    ALLOCATE(DYYTCA(LCM))
    ALLOCATE(FVDISP(KCM,LCM))
  ENDIF
  
  IF( ISHDMF >= 1 )THEN
    ALLOCATE(FMDUX(LCM,KCM))
    ALLOCATE(FMDUY(LCM,KCM))
    ALLOCATE(FMDVX(LCM,KCM))
    ALLOCATE(FMDVY(LCM,KCM))
    IF( IS2TIM == 0 )ALLOCATE(H1C(LCM))
  ENDIF    
  
  IF( ISVEG > 0 )THEN
    ALLOCATE(FXVEG(LCM,KCM))
    ALLOCATE(FXVEGE(LCM))
    ALLOCATE(FYVEG(LCM,KCM))
    ALLOCATE(FYVEGE(LCM))
    ALLOCATE(LVEG(LCM))
    ALLOCATE(NVEGSERV(0:NVEGTPM))
    ALLOCATE(ALPVEG(0:NVEGTPM))
    ALLOCATE(BDLPSQ(0:NVEGTPM))
    ALLOCATE(BETVEG(0:NVEGTPM))
    ALLOCATE(BPVEG(0:NVEGTPM))
    ALLOCATE(GAMVEG(0:NVEGTPM))
    ALLOCATE(HPVEG(0:NVEGTPM))
    ALLOCATE(PVEGX(0:NVEGTPM))
    ALLOCATE(PVEGY(0:NVEGTPM))
    ALLOCATE(PVEGZ(0:NVEGTPM))
    ALLOCATE(RDLPSQ(0:NVEGTPM))
    ALLOCATE(SCVEG(0:NVEGTPM))
  ENDIF
  
  IF( ISWAVE > 0 )THEN
    ALLOCATE(FXWAVE(LCM,KCM))
    ALLOCATE(FYWAVE(LCM,KCM))
    ALLOCATE(WV(LCM))
    DO L=1,LCM
      ALLOCATE(WV(L).DISSIPA(KCM))
    ENDDO
  ENDIF
  
  ! *** FOODCHAIN MODELLING OPTIONS
  IF( ISTPOCB == 4 )THEN
    ALLOCATE(PFPOCB(LCM,KBM))
    ALLOCATE(FPOCB(LCM,KBM))
  ELSE
    ALLOCATE(PFPOCB(1,1))
    ALLOCATE(FPOCB(1,1))
  ENDIF

  ! ** TOXIC TRANSPORT VARIABLES
  ALLOCATE(ISDIFBW(NTXM))
  ALLOCATE(ISPMXZ(NTXM))
  ALLOCATE(ISTOC(NTXM))
  ALLOCATE(ISTOXR(NTXM))
  ALLOCATE(ITOXBU(NTXM))
  ALLOCATE(ITOXKIN(10,NTXM))
  ALLOCATE(ITOXWU(NTXM))
  ALLOCATE(ITXBDUT(NTXM))
  ALLOCATE(ITXINT(NTXM))
  ALLOCATE(ITXPARB(NSTM,NTXM))
  ALLOCATE(ITXPARBC(2,NTXM))
  ALLOCATE(ITXPARW(NSTM,NTXM))
  ALLOCATE(ITXPARWC(2,NTXM))

  ALLOCATE(CONPARB(NSTM,NTXM))
  ALLOCATE(CONPARBC(2,NTXM))
  ALLOCATE(CONPARW(NSTM,NTXM))
  ALLOCATE(CONPARWC(2,NTXM))
  ALLOCATE(DIFTOX(NTXM))
  ALLOCATE(DIFTOXS(NTXM))
  ALLOCATE(DPDIFTOX(NTXM))
  ALLOCATE(FPOCBST(NSTM,NTXM))
  ALLOCATE(FPOCWST(NSTM,NTXM))
  ALLOCATE(PDIFTOX(NTXM))
  ALLOCATE(RKTOXP(NTXM))
  ALLOCATE(SKTOXP(NTXM))
  ALLOCATE(TOXINTB(NTXM))
  ALLOCATE(TOXINTW(NTXM))
  ALLOCATE(TOX_BIO_KB(NTXM))
  ALLOCATE(TOX_BIO_KW(NTXM))
  ALLOCATE(TOX_BIO_MXD(NTXM))
  ALLOCATE(TOX_BIO_Q10B(NTXM))
  ALLOCATE(TOX_BIO_Q10W(NTXM))
  ALLOCATE(TOX_BIO_TB(NTXM))
  ALLOCATE(TOX_BIO_TW(NTXM))
  ALLOCATE(TOX_BLK_KB(NTXM))
  ALLOCATE(TOX_BLK_KW(NTXM))
  ALLOCATE(TOX_BLK_MXD(NTXM))
  ALLOCATE(TOX_ADJ(NTXM))
  ALLOCATE(TOX_ATM(NTXM))
  ALLOCATE(TOX_HE(NTXM))
  ALLOCATE(TOX_MW(NTXM))
  ALLOCATE(TOX_KV_TCOEFF(NTXM))

  ALLOCATE(TOXA(NTXM))
  ALLOCATE(TOXPARB(NSTM,NTXM))
  ALLOCATE(TOXPARBC(2,NTXM))
  ALLOCATE(TOXPARW(NSTM,NTXM))
  ALLOCATE(TOXPARWC(2,NTXM))
  ALLOCATE(TOX(LCM,KCM,NTXM))
  ALLOCATE(TOX1(LCM,KCM,NTXM))
  ALLOCATE(TOXAD(KCM,NTXM,1))

  IF( ISTRAN(5) >= 1 .OR. ISBAL > 0 .OR. NTOX > 0)THEN
    ALLOCATE(NSP2(NTXM))
    ALLOCATE(RTOXERE2T(NTXM))
    ALLOCATE(RTOXERE2TB(NTXM))
    ALLOCATE(RTOXERE2TW(NTXM))
    ALLOCATE(RTOXERO2T(NTXM))
    ALLOCATE(RTOXERO2TB(NTXM))
    ALLOCATE(RTOXERO2TW(NTXM))
    ALLOCATE(STPOCW(LCM,KCM))
    ALLOCATE(TAD(KCM,1))
    ALLOCATE(TADFLUX(LCM,NTXM))
    ALLOCATE(TADFLUX2T(NTXM))
    ALLOCATE(TOXATM(LCM,NTXM))
    ALLOCATE(TOXB(LCM,KBM,NTXM))
    ALLOCATE(TOXB1(LCM,KBM,NTXM))
    ALLOCATE(TOXBA(LCM,NTXM))
    ALLOCATE(TOXBA1(LCM,NTXM))
    ALLOCATE(TOXBEG2T(NTXM))
    ALLOCATE(TOXBEG2TB(NTXM))
    ALLOCATE(TOXBEG2TW(NTXM))
    ALLOCATE(TOXBINIT(LCM,KBM,NTXM))
    ALLOCATE(TOXBLB(NTXM))
    ALLOCATE(TOXBLB2T(NTXM))
    ALLOCATE(TOXBMO2T(NTXM))
    ALLOCATE(TOXBMO2TB(NTXM))
    ALLOCATE(TOXBMO2TW(NTXM))
    ALLOCATE(TOXBS(LCM,KBM,NTXM))
    ALLOCATE(TOXCDFB(LCM,KBM,NTXM))
    ALLOCATE(TOXCDFW(LCM,KCM,NTXM))
    ALLOCATE(TOXEND2T(NTXM))
    ALLOCATE(TOXEND2TB(NTXM))
    ALLOCATE(TOXEND2TW(NTXM))
    ALLOCATE(TOXERE2T(NTXM))
    ALLOCATE(TOXERE2TB(NTXM))
    ALLOCATE(TOXERE2TW(NTXM))
    ALLOCATE(TOXERO2T(NTXM))
    ALLOCATE(TOXERO2TB(NTXM))
    ALLOCATE(TOXERO2TW(NTXM))
    ALLOCATE(TOXERR2T(NTXM))
    ALLOCATE(TOXERR2TB(NTXM))
    ALLOCATE(TOXERR2TW(NTXM))
    ALLOCATE(TOXF(LCM,0:KCM,NTXM))   ! *** TOXIC CONTAMINANT SETTLING AND BED EXCHANGE FLUX  (G/M2/S)
    ALLOCATE(TOXFB(LCM,KBM,NTXM))    ! *** TOXIC CONTAMINANT FLUX IN THE SEDIMENT BED AND BED/WATER INTERFACE  (G/M2/S)
    ALLOCATE(TOXFBL(LCM,NTXM))       ! *** TOXIC CONTAMINANT FLUX AT THE BED/WATER INTERFACE DUE TO BEDLOAD   (G/M2/S)
    ALLOCATE(TOXFBL2T(NTXM))
    ALLOCATE(TOXFBLT(NTXM))
    ALLOCATE(TOXFBEBKB(LCM,NTXM))
    ALLOCATE(TOXFBECHB(LCM,NTXM))
    ALLOCATE(TOXFBECHW(LCM,NTXM))
    ALLOCATE(TOXFDFB(LCM,KBM,NTXM))
    ALLOCATE(TOXFDFW(LCM,KCM,NTXM))
    ALLOCATE(TOXFLUXB2T(NTXM))
    ALLOCATE(TOXFLUXW2T(NTXM))
    ALLOCATE(TOXINIT(LCM,KCM,NTXM))
    ALLOCATE(TOXOUT2T(NTXM))
    ALLOCATE(TOXOUT2TB(NTXM))
    ALLOCATE(TOXOUT2TW(NTXM))
    ALLOCATE(TOXPFB(LCM,KBM,NSTM+2,NTXM))
    ALLOCATE(TOXPFTB(LCM,KBM,NTXM))
    ALLOCATE(TOXPFTW(LCM,KCM,NTXM))
    ALLOCATE(TOXPFW(LCM,KCM,NSTM+2,NTXM))
    ALLOCATE(TOXS(LCM,KCM,NTXM))
    ALLOCATE(TOXTMP(LCM,0:KBM+1))
    ALLOCATE(TOXWBALN(LCM))
    ALLOCATE(TOXWBALO(LCM))
  ENDIF   ! *** END OF TOXIC VARIABLE DECLARATIONS
  
  ! ** SED VARIABLES
  ALLOCATE(SED(LCM,KCM,NSCM))
  ALLOCATE(SED1(LCM,KCM,NSCM))
  IF( ISTRAN(6) >= 1 .OR. ISBAL > 0 .OR. NSED > 0)THEN
    ALLOCATE(SED3DMAX(NSCM))
    ALLOCATE(SED3DMIN(NSCM))
    ALLOCATE(SEDA(NSCM))
    ALLOCATE(SEDAD(KCM,NSCM,1))
    ALLOCATE(SEDBA(LCM,NSCM))
    ALLOCATE(SEDBEG2T(NSCM))
    ALLOCATE(SEDBEG2TB(NSCM))
    ALLOCATE(SEDBEG2TW(NSCM))
    ALLOCATE(SEDBINIT(LCM,KBM,NSCM))
    ALLOCATE(SEDBMO2T(NSCM))
    ALLOCATE(SEDBMO2TB(NSCM))
    ALLOCATE(SEDBMO2TW(NSCM))
    ALLOCATE(SEDEND2T(NSCM))
    ALLOCATE(SEDEND2TB(NSCM))
    ALLOCATE(SEDEND2TW(NSCM))
    ALLOCATE(SEDERE2T(NSCM))
    ALLOCATE(SEDERE2TB(NSCM))
    ALLOCATE(SEDERE2TW(NSCM))
    ALLOCATE(SEDERO2T(NSCM))
    ALLOCATE(SEDERO2TB(NSCM))
    ALLOCATE(SEDERO2TW(NSCM))
    ALLOCATE(SEDERR2T(NSCM))
    ALLOCATE(SEDERR2TB(NSCM))
    ALLOCATE(SEDERR2TW(NSCM))
    ALLOCATE(SEDF(LCM,0:KCM,NSCM))      ! *** VERTICAL SED FLUX ACROSS CELL LAYER FACES (G/M2/S)
    ALLOCATE(SEDFLUX2T(NSCM))
    ALLOCATE(SEDINIT(LCM,KCM,NSCM))
    ALLOCATE(SEDOUT2T(NSCM))
    ALLOCATE(SEDOUT2TB(NSCM))
    ALLOCATE(SEDOUT2TW(NSCM))
    ALLOCATE(SEDS(LCM,KCM,NSCM))
  ENDIF   ! *** END OF SED VARIABLE DECLARATIONS
  
  ! ** SND VARIABLES
  ALLOCATE(SND(LCM,KCM,NSNM))
  ALLOCATE(SND1(LCM,KCM,NSNM))
  IF( NSND > 0 )THEN
    ALLOCATE(SBDLDA(NSNM))
    ALLOCATE(SBDLDB(NSNM))
    ALLOCATE(SBDLDG1(NSNM))
    ALLOCATE(SBDLDG2(NSNM))
    ALLOCATE(SBDLDG3(NSNM))
    ALLOCATE(SBDLDG4(NSNM))
    ALLOCATE(SBDLDP(NSNM))
  ENDIF
  IF( ISTRAN(7) >= 1 .OR. ISBAL > 0 )THEN
    ALLOCATE(SBLOUT2T(NSNM))
    ALLOCATE(SBLOUT2TB(NSNM))
    ALLOCATE(SBLOUT2TW(NSNM))
    ALLOCATE(SND3DMAX(NSNM))
    ALLOCATE(SND3DMIN(NSNM))
    ALLOCATE(SNDA(NSNM))
    ALLOCATE(SNDAD(KCM,NSNM,1))
    ALLOCATE(SNDBA(LCM,NSNM))
    ALLOCATE(SNDBA1(LCM,NSNM))
    ALLOCATE(SNDBAT(LCM))
    ALLOCATE(SNDBEG2T(NSNM))
    ALLOCATE(SNDBEG2TB(NSNM))
    ALLOCATE(SNDBEG2TW(NSNM))
    ALLOCATE(SNDBINIT(LCM,KBM,NSNM))
    ALLOCATE(SNDBMO2T(NSNM))
    ALLOCATE(SNDBMO2TB(NSNM))
    ALLOCATE(SNDBMO2TW(NSNM))
    ALLOCATE(SNDBS(LCM,KBM,NSNM))
    ALLOCATE(SNDEND2T(NSNM))
    ALLOCATE(SNDEND2TB(NSNM))
    ALLOCATE(SNDEND2TW(NSNM))
    ALLOCATE(SNDEQ(LCM))
    ALLOCATE(SNDEQSAV(LCM,NSNM))
    ALLOCATE(SNDEQB(LCM))
    ALLOCATE(SNDERE2T(NSNM))
    ALLOCATE(SNDERE2TB(NSNM))
    ALLOCATE(SNDERE2TW(NSNM))
    ALLOCATE(SNDERO2T(NSNM))
    ALLOCATE(SNDERO2TB(NSNM))
    ALLOCATE(SNDERO2TW(NSNM))
    ALLOCATE(SNDERR2T(NSNM))
    ALLOCATE(SNDERR2TB(NSNM))
    ALLOCATE(SNDERR2TW(NSNM))
    ALLOCATE(SNDF(LCM,0:KCM,NSNM))      ! *** VERTICAL SND FLUX ACROSS CELL LAYER FACES (G/M2/S)
    ALLOCATE(SNDFBL(LCM,NSNM))          ! *** BED/WATER INTERFACE SND FLUX DUE TO BEDLOAD (G/M2/S)
    ALLOCATE(SNDFBL2T(NSNM))
    ALLOCATE(SNDFLUX2T(NSNM))
    ALLOCATE(SNDINIT(LCM,KCM,NSNM))
    ALLOCATE(SNDOUT2T(NSNM))
    ALLOCATE(SNDOUT2TB(NSNM))
    ALLOCATE(SNDOUT2TW(NSNM))
    ALLOCATE(SNDS(LCM,KCM,NSNM))
  ENDIF   ! *** END OF SND VARIABLE DECLARATIONS
  
  ! *** EITHER SED OR SND
  ALLOCATE(IBLTAUC(NSTM))
  ALLOCATE(ISEDWU(NSTM))
  ALLOCATE(IROUSE(NSTM))
  ALLOCATE(ISBDLD(NSTM))
  ALLOCATE(ISEDSCOR(NSTM))
  ALLOCATE(ISLTAUC(NSTM))
  ALLOCATE(ISNDEQ(NSTM))
  ALLOCATE(ISNDM1(NSTM))
  ALLOCATE(ISNDM2(NSTM))
  ALLOCATE(IWRSPB(NSTM))
  ALLOCATE(ISPROBDEP(NSTM))
  
  ALLOCATE(COSEDHID(NSTM))
  ALLOCATE(RSNDM(NSTM))
  ALLOCATE(SDBLV(NSTM))
  ALLOCATE(SDEN(NSTM))               ! ***  SPECIFIC VOLUME OF EACH SEDIMENT CLASS (M3/G)
  ALLOCATE(SEDN(NSTM))
  ALLOCATE(SEDO(NSTM))
  ALLOCATE(SEDBO(NSTM))
  ALLOCATE(SEDDIA(NSTM))
  ALLOCATE(SEXP(NSTM))
  ALLOCATE(SSG(NSTM))
  ALLOCATE(TAUD(NSTM))
  ALLOCATE(TAUN(NSTM))
  ALLOCATE(TAUR(NSTM))
  ALLOCATE(TCSHIELDS(NSTM))
  ALLOCATE(TEXP(NSTM))
  ALLOCATE(VDRDEPO(NSTM))
  ALLOCATE(VDRRSPO(NSTM))
  ALLOCATE(WRSPO(NSTM))
  ALLOCATE(WSEDO(NSTM))
  ALLOCATE(WS(NTSM))
  ALLOCATE(WS2(NTSM))

  IF( ISTRAN(6) >= 1 .OR. ISTRAN(7) >= 1 .OR. ISBAL > 0 )THEN
    ALLOCATE(ACOEF(LCM,0:KBM))
    ALLOCATE(ALOW(LCM,0:KBM+1))
    ALLOCATE(BDENBED(LCM,KBM))
    ALLOCATE(BDENBED1(LCM,KBM))
    ALLOCATE(BDENBEDA(LCM))
    ALLOCATE(BDENBEDA1(LCM))
    ALLOCATE(BEDBINIT(LCM,KBM))
    ALLOCATE(BEDBKDSV(LCM,KBM))
    ALLOCATE(BEDDINIT(LCM,KBM))
    ALLOCATE(BEDLINIT(LCM,KBM))
    ALLOCATE(BEDPORSV(LCM,KBM))
    ALLOCATE(BEDTHKSV(LCM,KBM))
    ALLOCATE(BEDVDRSV(LCM,KBM))
    ALLOCATE(BMNN(LCM,0:KBM+1))
    ALLOCATE(CBEDTOTAL(LCM))
    ALLOCATE(COEFK(LCM,KBM))
    ALLOCATE(COEFSK(LCM,KBM))
    ALLOCATE(CQBEDLOADX(LCM,NSNM))
    ALLOCATE(CQBEDLOADY(LCM,NSNM))
    ALLOCATE(CSHIELDS50(LCM))
    ALLOCATE(CUPP(LCM,0:KBM+1))
    ALLOCATE(DSTRSE(LCM,KBM))
    ALLOCATE(DZBTR(LCM,KBM))
    ALLOCATE(DZBTR1(LCM,KBM))
    ALLOCATE(FRACCOH(LCM,KBM))
    ALLOCATE(FRACNON(LCM,KBM))
    ALLOCATE(GAMTMP(LCM,0:KBM+1))
    ALLOCATE(HBED(LCM,KBM))
    ALLOCATE(HBED1(LCM,KBM))
    ALLOCATE(HYDCN(LCM,KBM))
    
    ALLOCATE(ISEDBU(NSCM))
    ALLOCATE(ISNDBU(NSNM))
    ALLOCATE(ISNDWU(NSNM))
    ALLOCATE(ISDBLDIR(LCM))
  
    ALLOCATE(JSS3DSED(NSCM))
    ALLOCATE(JSS3DSND(NSNM))
    ALLOCATE(JSS3DTOX(NTXM))
    ALLOCATE(PEXP(LCM,NSNM))
    ALLOCATE(PHID(LCM,NSNM))
    ALLOCATE(QSBDLDIN(LCM,NSNM))                ! *** BEDLOAD FLUX IN  DUE TO FIXING BOUNDARY CONDITION CELLS TO ZERO BEDLOAD DELTA  (G/S)
    ALLOCATE(QSBDLDOT(LCM,MAX(NSNM,NSCM)))      ! *** BEDLOAD FLUX OUT DUE TO FIXING BOUNDARY CONDITION CELLS TO ZERO BEDLOAD DELTA  (G/S)
    ALLOCATE(QSBDLDX(LCM,MAX(NSNM,NSCM)))       ! *** U FACE SND FLUX DUE TO BEDLOAD (G/S)
    ALLOCATE(QSBDLDY(LCM,MAX(NSNM,NSCM)))       ! *** V FACE SND FLUX DUE TO BEDLOAD (G/S)
    ALLOCATE(QSBDLDP(LCM))                      ! *** CELL CENTER BED LOAD TRANSPORT RATE (G/M/S)
    ALLOCATE(QSBDTOP(LCM))
    ALLOCATE(QSEDBED(LCM,KBM,NSTM))
    ALLOCATE(QSEDBED1(LCM,KBM,NSTM))
    ALLOCATE(QSEDBEDA(LCM,NSTM))
    ALLOCATE(QSEDBEDA1(LCM,NSTM))

    ALLOCATE(SEDDIA50(LCM,KBM))
    ALLOCATE(SEDDIA90(LCM,KBM))

    ALLOCATE(SEDB(LCM,KBM,NSCM))
    ALLOCATE(SEDB1(LCM,KBM,NSCM))
    ALLOCATE(SEDBT(LCM,KBM))
    ALLOCATE(SEDFPA(LCM,NSCM))
    ALLOCATE(SEDT(LCM,KCM))

    ALLOCATE(SNDB(LCM,KBM,NSNM))
    ALLOCATE(SNDB1(LCM,KBM,NSNM))
    ALLOCATE(SNDBT(LCM,KBM))
    ALLOCATE(SNDFPA(LCM,NSNM))
    ALLOCATE(SNDT(LCM,KCM))

    ALLOCATE(TAUBSED(LCM))
    ALLOCATE(TAUBSND(LCM))
    ALLOCATE(TAUCRCOH(LCM,KBM))
    ALLOCATE(TAURB(LCM,KBM))
    ALLOCATE(TAUDS(LCM))
    ALLOCATE(TAUNS(LCM,KBM))
    ALLOCATE(TAURS(LCM,KBM))
    ALLOCATE(TEXPS(LCM,KBM))

    ALLOCATE(VDRBED(LCM,KBM))
    ALLOCATE(VDRBED1(LCM,KBM))
    ALLOCATE(VDRBED2(LCM,KBM))
    ALLOCATE(VDRBEDA(LCM))
    ALLOCATE(VDRBEDSED(LCM,KBM))
    ALLOCATE(VDRBEDSND(LCM,KBM))
    ALLOCATE(VDRHBEDA1(LCM))
    ALLOCATE(VFRBED(LCM,KBM,NSTM))
    ALLOCATE(VFRBED1(LCM,KBM,NSTM))
    ALLOCATE(VOLBW2(LCM,KBM))
    ALLOCATE(VOLBW3(LCM,KBM))
    ALLOCATE(WSETA(LCM,0:KSM,NSTM))
    ALLOCATE(WRSPB(LCM,KBM))
    ALLOCATE(WRSPBA(LCM))
    ALLOCATE(WRSPS(LCM,KBM))
    ALLOCATE(WRSPSA(LCM))
    ALLOCATE(ZBEDC(LCM,KBM))
    ALLOCATE(ZBEDG(LCM,0:KBM))
    ALLOCATE(ZBEDGT(LCM))
    IF( ISBEDSTR == 3 )THEN
      ALLOCATE(ZBRSED(LCM))
    ELSE
      ALLOCATE(ZBRSED(1))
    ENDIF
    ALLOCATE(ZELBED(LCM,KBM))
    ALLOCATE(ZELBED1(LCM,KBM))
    ALLOCATE(ZELBEDA(LCM))
    ALLOCATE(ZELBEDA1(LCM))

    ALLOCATE(PARTMIXZ(LCM,KBM))
    ALLOCATE(PMXDEPTH(NPMXPTSM,NPMXZM))
    ALLOCATE(PMXCOEF(NPMXPTSM,NPMXZM))
    ALLOCATE(PORBED(LCM,KBM))
    ALLOCATE(PORBED1(LCM,KBM))
    ALLOCATE(QCOEF(LCM,0:KBM))
    ALLOCATE(QWTRBED(LCM,0:KBM))
    ALLOCATE(QWTRBED1(LCM,0:KBM))
    ALLOCATE(QWTRBEDA(LCM))
    ALLOCATE(QWTRBEDA1(LCM))
    ALLOCATE(RRHS(LCM,0:KBM+1))
    ALLOCATE(RSEDERE2T(NSCM))
    ALLOCATE(RSEDERE2TB(NSCM))
    ALLOCATE(RSEDERE2TW(NSCM))
    ALLOCATE(RSEDERO2T(NSCM))
    ALLOCATE(RSEDERO2TB(NSCM))
    ALLOCATE(RSEDERO2TW(NSCM))
    ALLOCATE(RSNDERE2T(NSNM))
    ALLOCATE(RSNDERE2TB(NSNM))
    ALLOCATE(RSNDERE2TW(NSNM))
    ALLOCATE(RSNDERO2T(NSNM))
    ALLOCATE(RSNDERO2TB(NSNM))
    ALLOCATE(RSNDERO2TW(NSNM))
    ALLOCATE(SDENAVG(LCM,KBM))
    ALLOCATE(SGSM1(LCM,KBM))
    ALLOCATE(SIGPHI(LCM,KBM))
    ALLOCATE(STDOCB(LCM,KBM))
    ALLOCATE(STDOCW(LCM,KCM))
    ALLOCATE(STFPOCB(LCM,KBM,NSTM))
    ALLOCATE(STFPOCW(LCM,KCM,NSTM))
    ALLOCATE(STPOCB(LCM,KBM))
    ALLOCATE(STRSE(LCM,KBM))

    ! *** BANK EROSION
    ALLOCATE(IBANKBE(NBEPAIRM))
    ALLOCATE(JBANKBE(NBEPAIRM))
    ALLOCATE(ICHANBE(NBEPAIRM))
    ALLOCATE(JCHANBE(NBEPAIRM))
    ALLOCATE(NBESERN(NBEPAIRM))
    ALLOCATE(MBESER(NBESERM))
    ALLOCATE(MBETLAST(NBESERM))
    ALLOCATE(LPMXZ(LCM))
  ENDIF
  
  ! *** CALMMT/RESIDUAL/MODEL LINKAGES VARIABLES
  IF( ISSSMMT /= 2 )THEN
    ALLOCATE(EVPGLPF(LCM))                    ! *** MMT - AVERAGE TRANSPIRATION RATE (M3/S)
    ALLOCATE(EVPSLPF(LCM))                    ! *** MMT - AVERAGE EVAPORATION RATE (M3/S)
    ALLOCATE(GWLPF(LCM))                      ! *** MMT - AVERAGE GROUNDWATER ELEVATION BELOW CELL (M)
    ALLOCATE(HLPF(LCM))                       ! *** MMT - AVERAGE DEPTH
    ALLOCATE(QSUMELPF(LCM))
    ALLOCATE(QSUMLPF(LCM,KCM))
    ALLOCATE(RAINLPF(LCM))                    ! *** MMT - ACCUMULATED RAINFALL (M3/S)
    ALLOCATE(RINFLPF(LCM))                    ! *** ISGWIE > 0: MMT -ACCUMULATED INFILTRATION RATE (M3/S)
    ALLOCATE(SALLPF(LCM,KCM))
    ALLOCATE(SFLLPF(LCM,KCM))
    ALLOCATE(TEMLPF(LCM,KCM))
    ALLOCATE(UELPF(LCM))                      ! *** MMT - AVERAGE DEPTH AVERAGED U VELOCITY
    ALLOCATE(VELPF(LCM))                      ! *** MMT - AVERAGE DEPTH AVERAGED V VELOCITY
    ALLOCATE(WLPF(LCM,0:KCM))
    ALLOCATE(WTLPF(LCM,KSM))
    
    IF( ISTRAN(5) > 0 )THEN
      ALLOCATE(TOXBLPF(LCM,KBM,NTXM))
      ALLOCATE(TOXLPF(LCM,KCM,NTXM))
      ALLOCATE(TXPFLPF(LCM,KCM,NSTM+2,NTXM))  ! ***
    ENDIF
    IF( ISTRAN(6) > 0 )THEN
      ALLOCATE(SEDBLPF(LCM,KBM,NSCM))
      ALLOCATE(SEDBTLPF(LCM,KBM))
      ALLOCATE(SEDLPF(LCM,KCM,NSCM))
      ALLOCATE(SEDTLPF(LCM,KCM))
    ENDIF
    IF( ISTRAN(7) > 0 )THEN
      ALLOCATE(SNDBLPF(LCM,KBM,NSNM))
      ALLOCATE(SNDBTLPF(LCM,KBM))
      ALLOCATE(SNDLPF(LCM,KCM,NSNM))
      ALLOCATE(SNDTLPF(LCM,KCM))
    ENDIF
  ENDIF
  
  ! ** WATER QUALITY VARIABLES
  ALLOCATE(WQKEB(1))
  IF( ISTRAN(8) >= 1 )THEN
    ALLOCATE(CYASUM(LCMWQ,KCM))
    ALLOCATE(DDOMAX(LCMWQ,KCM))
    ALLOCATE(DDOMIN(LCMWQ,KCM))
    ALLOCATE(DZWQ(LCMWQ))
    ALLOCATE(IBENMAP(LCMWQ,2))
    ALLOCATE(ICPSL(NWQPSM))
    ALLOCATE(ICWQTS(0:NWQVM,NWQTSM))
    ALLOCATE(IMWQZT(LCMWQ))
    ALLOCATE(IMWQZT1(LCMWQ))
    ALLOCATE(IMWQZT2(LCMWQ))
    ALLOCATE(ISMT(LCMWQ))
    ALLOCATE(ISMZMAP(LCMWQ))
    ALLOCATE(JCPSL(NWQPSM))
    ALLOCATE(KCPSL(NWQPSM))
    ALLOCATE(MVPSL(NWQPSM))
    ALLOCATE(MWQCTLT(NWQCSRM,NWQVM))
    ALLOCATE(MWQPSR(NWQPSRM))
    ALLOCATE(MWQPTLT(NWQPSRM))
    ALLOCATE(O2WQ(LCM))
    ALLOCATE(PO4DWQ(LCM))
    ALLOCATE(REAC(NWQZM))
    ALLOCATE(RKASUM(LCMWQ,KCM))
    ALLOCATE(RLIGHTC(LCMWQ,KCM))
    ALLOCATE(RLIGHTT(LCMWQ,KCM))
    ALLOCATE(RNH4NO3(LCM))
    ALLOCATE(RNH4WQ(LCM))
    ALLOCATE(RNO3WQ(LCM))
    ALLOCATE(SM1H2S(LCMWQ))
    ALLOCATE(SM1NH4(LCMWQ))
    ALLOCATE(SM1NO3(LCMWQ))
    ALLOCATE(SM1PO4(LCMWQ))
    ALLOCATE(SM1SI(LCMWQ))
    ALLOCATE(SM2H2S(LCMWQ))
    ALLOCATE(SM2NH4(LCMWQ))
    ALLOCATE(SM2NO3(LCMWQ))
    ALLOCATE(SM2PO4(LCMWQ))
    ALLOCATE(SM2SI(LCMWQ))

    ALLOCATE(SMAC(LCM))
    ALLOCATE(SMBST(LCMWQ))
    ALLOCATE(SMCSOD(LCMWQ))
    ALLOCATE(SMD1PO4(LCMWQ))
    ALLOCATE(SMD1SI(LCMWQ))
    ALLOCATE(SMDD(NSMZM))
    ALLOCATE(SMDFC(LCMWQ,NSMGM))
    ALLOCATE(SMDFN(LCMWQ,NSMGM))
    ALLOCATE(SMDFP(LCMWQ,NSMGM))
    ALLOCATE(SMDFSI(LCMWQ))
    ALLOCATE(SMDGFC(LCMWQ))
    ALLOCATE(SMDGFN(LCMWQ))
    ALLOCATE(SMDGFP(LCMWQ))
    ALLOCATE(SMDP(NSMZM))
    ALLOCATE(SMDP1PO4(NSMZM))
    ALLOCATE(SMDPMIN(NSMZM))
    ALLOCATE(SMDTOH(NSMZM))
    ALLOCATE(SMFCBC(NSMGM))
    ALLOCATE(SMFCBD(NSMGM))
    ALLOCATE(SMFCBG(NSMGM))
    ALLOCATE(SMFCR(NSMZM,NSMGM))
    ALLOCATE(SMFNBC(NSMGM))
    ALLOCATE(SMFNBD(NSMGM))
    ALLOCATE(SMFNBG(NSMGM))
    ALLOCATE(SMFNR(NSMZM,NSMGM))
    ALLOCATE(SMFPBC(NSMGM))
    ALLOCATE(SMFPBD(NSMGM))
    ALLOCATE(SMFPBG(NSMGM))
    ALLOCATE(SMFPR(NSMZM,NSMGM))
    ALLOCATE(SMHODT(NSMZM))
    ALLOCATE(SMHSED(NSMZM))
    ALLOCATE(SMHYPD(LCMWQ))
    ALLOCATE(SMHYST(LCMWQ))
    ALLOCATE(SMJAQH2S(LCMWQ))
    ALLOCATE(SMJDEN(LCMWQ))
    ALLOCATE(SMJGCH4(LCMWQ))
    ALLOCATE(SMJNIT(LCMWQ))
    ALLOCATE(SMK1H2S(NWQTDM))
    ALLOCATE(SMK1NO3(NSMZM))
    ALLOCATE(SMK2NO3(NSMZM))
    ALLOCATE(SMKL12(LCM))
    ALLOCATE(SMKNH4(NSMZM))
    ALLOCATE(SMNSOD(LCMWQ))
    ALLOCATE(SMPOC(LCMWQ,NSMGM))
    ALLOCATE(SMPON(LCMWQ,NSMGM))
    ALLOCATE(SMPOP(LCMWQ,NSMGM))
    ALLOCATE(SMPSI(LCMWQ))
    ALLOCATE(SMSS(LCMWQ))
    ALLOCATE(SMT(LCMWQ))
    ALLOCATE(SMTD1CH4(NWQTDM))
    ALLOCATE(SMTD2CH4(NWQTDM))
    ALLOCATE(SMTDCD(NWQTDM,NSMGM))
    ALLOCATE(SMTDDD(NWQTDM))
    ALLOCATE(SMTDDP(NWQTDM))
    ALLOCATE(SMTDND(NWQTDM,NSMGM))
    ALLOCATE(SMTDNH4(NWQTDM))
    ALLOCATE(SMTDNO3(NWQTDM))
    ALLOCATE(SMTDPD(NWQTDM,NSMGM))
    ALLOCATE(SMTDSI(NWQTDM))
    ALLOCATE(SMTMP(LCM))
    ALLOCATE(SMW12(LCM))
    ALLOCATE(SMW2(NSMZM))
    ALLOCATE(SMW2DTOH(NSMZM))
    ALLOCATE(SMW2PHODT(NSMZM))
    ALLOCATE(SODMULT(NSMZM))
    ALLOCATE(SODSUM(LCMWQ,KCM))
    ALLOCATE(SWQSUM(LCMWQ,KCM))
    ALLOCATE(TCWQPSR(NWQPSRM))
    ALLOCATE(TEMSUM(LCMWQ,KCM))
    ALLOCATE(XBENMUD(LCMWQ))
    ALLOCATE(XDOSAT(LCMWQ,KCM))
    ALLOCATE(XSMO20(LCMWQ))

    ALLOCATE(IWQCBE(NBBEM))
    ALLOCATE(IWQCBN(NBBNM))
    ALLOCATE(IWQCBS(NBBSM))
    ALLOCATE(IWQCBW(NBBWM))
    ALLOCATE(IWQKA(NWQZM))
    ALLOCATE(IWQOBE(NBBEM,NWQVM))
    ALLOCATE(IWQOBN(NBBNM,NWQVM))
    ALLOCATE(IWQOBS(NBBSM,NWQVM))
    ALLOCATE(IWQOBW(NBBWM,NWQVM))
    ALLOCATE(IWQPSC(LCMWQ,KCM))
    ALLOCATE(IWQPSV(LCMWQ,KCM))
    ALLOCATE(IWQT(LCMWQ))
    ALLOCATE(IWQZMAP(LCMWQ,KCM))
    ALLOCATE(TWQ(LCMWQ))
    ALLOCATE(SWQ(LCMWQ))
    ALLOCATE(TWQPSER(NDWQPSR,NWQPSRM))

    ALLOCATE(UHEQ(LCMWQ))

    ALLOCATE(VOLWQ(LCMWQ))
    ALLOCATE(WQAPC(LCMWQ))
    ALLOCATE(WQATML(LCMWQ,KCM,NWQVM))
    ALLOCATE(WQBCSET(LCMWQ,2))
    ALLOCATE(WQBDSET(LCMWQ,2))
    ALLOCATE(WQBFCOD(LCMWQ))
    ALLOCATE(WQBFNH4(LCMWQ))
    ALLOCATE(WQBFNO3(LCMWQ))
    ALLOCATE(WQBFO2(LCMWQ))
    ALLOCATE(WQBFPO4D(LCMWQ))
    ALLOCATE(WQBFSAD(LCMWQ))
    ALLOCATE(WQBGSET(LCMWQ,2))
    ALLOCATE(WQBMC(LCMWQ))
    ALLOCATE(WQBMD(LCMWQ))
    ALLOCATE(WQBMG(LCMWQ))
    ALLOCATE(WQBMM(LCMWQ))
    ALLOCATE(WQBMRC(NWQZM))
    ALLOCATE(WQBMRD(NWQZM))
    ALLOCATE(WQBMRG(NWQZM))
    ALLOCATE(WQBMRM(NWQZM))
    ALLOCATE(WQCHL(LCMWQ,KCM))
    ALLOCATE(WQDENIT(LCMWQ))
    ALLOCATE(WQDFBC(LCMWQ))
    ALLOCATE(WQDFBD(LCMWQ))
    ALLOCATE(WQDFBG(LCMWQ))
    ALLOCATE(WQDFLC(LCMWQ))
    ALLOCATE(WQDFLN(LCMWQ))
    ALLOCATE(WQDFLP(LCMWQ))
    ALLOCATE(WQDFRC(LCMWQ))
    ALLOCATE(WQDFRN(LCMWQ))
    ALLOCATE(WQDFRP(LCMWQ))
    ALLOCATE(WQDFSI(LCMWQ))
    ALLOCATE(WQDOPM(NWQZM))
    ALLOCATE(WQDOS(LCM))
    ALLOCATE(WQH10(LCMWQ))
    ALLOCATE(WQHT(KCM))
    ALLOCATE(WQI0BOT(LCM))
    ALLOCATE(WQKBP(LCMWQ))
    ALLOCATE(WQKCD(NWQZM))
    ALLOCATE(WQKCOD(NWQTDM,NWQZM))
    ALLOCATE(WQKDC(NWQZM))
    ALLOCATE(WQKDCALM(NWQZM))
    ALLOCATE(WQKDON(LCMWQ))
    ALLOCATE(WQKDOP(LCMWQ))
    DEALLOCATE(WQKEB)
    ALLOCATE(WQKEB(NWQZM))
    ALLOCATE(WQKHCOD(NWQZM))
    ALLOCATE(WQKHR(LCMWQ))
    ALLOCATE(WQKHRM(NWQZM))
    ALLOCATE(WQKK(LCMWQ))
    ALLOCATE(WQKLPC(LCMWQ))
    ALLOCATE(WQKLPN(LCMWQ))
    ALLOCATE(WQKLPP(LCMWQ))
    ALLOCATE(WQKMV(LCMWQ))
    ALLOCATE(WQKMVA(LCMWQ))
    ALLOCATE(WQKMVB(LCMWQ))
    ALLOCATE(WQKMVC(LCMWQ))
    ALLOCATE(WQKMVD(LCMWQ))
    ALLOCATE(WQKMVE(LCMWQ))
    ALLOCATE(WQKMVMIN(LCMWQ))
    ALLOCATE(WQKRDOS(LCMWQ))
    ALLOCATE(WQKRO(NWQZM))
    ALLOCATE(WQKRPC(LCMWQ))
    ALLOCATE(WQKRPN(LCMWQ))
    ALLOCATE(WQKRPP(LCMWQ))
    ALLOCATE(WQKSUA(NWQTDM))
    ALLOCATE(WQKTR(NWQZM))
    ALLOCATE(WQLPSET(LCMWQ,2))
    ALLOCATE(WQN17(LCMWQ))
    ALLOCATE(WQNIT(LCMWQ))
    ALLOCATE(WQO18(LCMWQ))
    ALLOCATE(WQOBCE(NBBEM,2,NWQVM))
    ALLOCATE(WQOBCN(NBBNM,2,NWQVM))
    ALLOCATE(WQOBCS(NBBSM,2,NWQVM))
    ALLOCATE(WQOBCW(NBBWM,2,NWQVM))
    ALLOCATE(WQOBTOT(LCM))
    ALLOCATE(WQP19(LCMWQ))
    ALLOCATE(WQPC(LCMWQ))
    ALLOCATE(WQPD(LCMWQ))
    ALLOCATE(WQPG(LCMWQ))
    ALLOCATE(WQPM(LCMWQ))
    ALLOCATE(WQPMC(NWQZM))
    ALLOCATE(WQPMD(NWQZM))
    ALLOCATE(WQPMG(NWQZM))
    ALLOCATE(WQPMM(NWQZM))
    ALLOCATE(WQPNC(LCMWQ))
    ALLOCATE(WQPND(LCMWQ))
    ALLOCATE(WQPNG(LCMWQ))
    ALLOCATE(WQPNM(LCMWQ))
    ALLOCATE(WQPO4D(LCMWQ,KCM))
    ALLOCATE(WQPRC(LCMWQ))
    ALLOCATE(WQPRD(LCMWQ))
    ALLOCATE(WQPRG(LCMWQ))
    ALLOCATE(WQPRM(LCMWQ))
    ALLOCATE(WQPRRC(NWQZM))
    ALLOCATE(WQPRRD(NWQZM))
    ALLOCATE(WQPRRG(NWQZM))
    ALLOCATE(WQPRRM(NWQZM))
    ALLOCATE(WQPSQ(0:NWQPSM))
    ALLOCATE(WQPSSER(NDWQPSR,NWQVM,NWQPSRM))
    ALLOCATE(WQPSSRT(NWQVM,0:NWQPSRM))
    ALLOCATE(WQR20(LCMWQ))
    ALLOCATE(WQRPSET(LCMWQ,2))
    ALLOCATE(WQRR(LCMWQ))
    ALLOCATE(WQSAD(LCMWQ,KCM))
    ALLOCATE(WQSDCOEF(NWQZM))
    ALLOCATE(WQT10(LCMWQ))
    ALLOCATE(WQT17(LCMWQ))
    ALLOCATE(WQTAMP(LCMWQ,KCM))
    ALLOCATE(WQTD1FCB(NWQTDM))
    ALLOCATE(WQTD2FCB(NWQTDM))
    ALLOCATE(WQTDGC(NWQTDM))
    ALLOCATE(WQTDGD(NWQTDM))
    ALLOCATE(WQTDGG(NWQTDM))
    ALLOCATE(WQTDGM(NWQTDM))
    ALLOCATE(WQTDGP(NWQTDM))
    ALLOCATE(WQTDHDR(NWQTDM))
    ALLOCATE(WQTDKR(NWQTDM,NWQZM))
    ALLOCATE(WQTDMNL(NWQTDM))
    ALLOCATE(WQTDNIT(NWQTDM))
    ALLOCATE(WQTDRC(NWQTDM))
    ALLOCATE(WQTDRD(NWQTDM))
    ALLOCATE(WQTDRG(NWQTDM))
    ALLOCATE(WQTDRM(NWQTDM))
    ALLOCATE(WQTDTAM(NWQTDM))
    ALLOCATE(WQV(LCMWQ,KCM,0:NWQVM))
    ALLOCATE(WQVO(LCMWQ,KCM,0:NWQVM))
    ALLOCATE(WQWDSL(LCMWQ,KCM,NWQVM))
    ALLOCATE(WQWPSL(LCMWQ,KCM,NWQVM))
    ALLOCATE(WQWPSLC(0:NWQPSM,NWQVM))
    ALLOCATE(WQWSC(NWQZM))
    ALLOCATE(WQWSD(NWQZM))
    ALLOCATE(WQWSG(NWQZM))
    ALLOCATE(WQWSLP(NWQZM))
    ALLOCATE(WQWSRP(NWQZM))
    ALLOCATE(WQWSS(NWQZM))
    ALLOCATE(WQWSSET(LCMWQ,2))
    
    ! *** Dissolved carbon dioxide variables
    ALLOCATE(CO2WQ(LCMWQ))
    ALLOCATE(CDOSATIDX(LCM))
    ALLOCATE(WQCDOS(LCM))
    ALLOCATE(WQITOP(LCM,KCM))
    ALLOCATE(WQP22(LCMWQ))
    ALLOCATE(WQKRCDOS(LCMWQ))
  
  ENDIF   ! *** END OF WQ VARIABLE DECLARATIONS
  
  IF( ISWQFLUX == 1 )THEN
    ALLOCATE(ABEFF(LCM,KSM))
    ALLOCATE(ABLPF(LCM,KSM))
    ALLOCATE(ACCWFLD(LCM,2))
    ALLOCATE(AHULPF(LCM,KCM))
    ALLOCATE(AHVLPF(LCM,KCM))
    ALLOCATE(DYELPF(LCM,KCM))

    ALLOCATE(ISPV(LCM,10))
    ALLOCATE(IVPV(LCM,10))
    ALLOCATE(JSPV(LCM,10))
    ALLOCATE(JVPV(LCM,10))

    ALLOCATE(UHLPF(LCM,KCM))
    ALLOCATE(UIRT(LCM,KCM))
    ALLOCATE(ULPF(LCM,KCM))
    ALLOCATE(ULSHA(KCM,MLM))
    ALLOCATE(UTLPF(LCM,KCM))
    ALLOCATE(UTLSHA(KCM,MLM))
    ALLOCATE(UVPT(LCM,KCM))
    ALLOCATE(U1DT1(KCM,MLM))

    ALLOCATE(VHLPF(LCM,KCM))
    ALLOCATE(VIRT(LCM,KCM))
    ALLOCATE(VLPF(LCM,KCM))
    ALLOCATE(VLSHA(KCM,MLM))
    ALLOCATE(VTLPF(LCM,KCM))
    ALLOCATE(VTLSHA(KCM,MLM))
    ALLOCATE(VVPT(LCM,KCM))
    ALLOCATE(V1DT1(KCM,MLM))

    ALLOCATE(WIRT(LCM,KSM))

    ALLOCATE(UHDYWQ(LCM,KCM))
    ALLOCATE(UWQ(LCM,KCM))
    ALLOCATE(VHDXWQ(LCM,KCM))
    ALLOCATE(VWQ(LCM,KCM))
    ALLOCATE(WWQ(LCM,0:KCM))
  ENDIF
  
  IF( ISWASP > 0 )THEN
    ALLOCATE(LCEFDC(LCM*KCM))
    ALLOCATE(LCHNC(KCM*LCM,10))
    ALLOCATE(NCHNC(0:KCM*LCM))
  ELSE
    ALLOCATE(LCEFDC(1))
    ALLOCATE(LCHNC(1,1))
    ALLOCATE(NCHNC(0:1))
  ENDIF
  
  ! Begin SEDZLJ variables
  ALLOCATE(FWVTP(LCM))
  ALLOCATE(FWDIR(LCM,16))
  IF( LSEDZLJ )THEN
    ALLOCATE(ALPHA_PX(LCM))
    ALLOCATE(ALPHA_PY(LCM))
    ALLOCATE(ALPHA_RX(LCM,NSCM))
    ALLOCATE(ALPHA_RY(LCM,NSCM))
    ALLOCATE(BEDMAP(LCM))
    ALLOCATE(BLFLAG(LCM,NSCM))
    ALLOCATE(BULKDENS(KB,LCM))
    ALLOCATE(D50(NSCM))
    ALLOCATE(D50AVG(LCM))
    ALLOCATE(DEPO(LCM))
    ALLOCATE(DISTAR(NSCM))
    ALLOCATE(DZBL(LCM,NSCM))
    !ALLOCATE(DZBL_LAST(LCM,NSCM))
    ALLOCATE(DWS(NSCM))
    ALLOCATE(DWSIN(NSCM))
    ALLOCATE(ERATETEMP(20,KB,ITBM))
    ALLOCATE(ERATEND(NSICM,ITBM))
    ALLOCATE(ERATE(KB,LCM,ITBM))
    ALLOCATE(ESUS(LCM))
    ALLOCATE(ETOTO(LCM))
    ALLOCATE(HPCM(LCM))
    ALLOCATE(KPART(NTXM))
    ALLOCATE(LAYERACTIVE(KB,LCM))
    ALLOCATE(NCORENO(IC,JC))
    ALLOCATE(PERSED(NSCM,KB,LCM))
    ALLOCATE(PSUS(LCM,NSCM))
    ALLOCATE(QBLFLUX(LCM,NSCM))
    ALLOCATE(SCND(NSICM))
    ALLOCATE(SH_SCALE(LCM))
    ALLOCATE(SSGI(NSCM))
    ALLOCATE(STWVHT(LCM,200))
    ALLOCATE(STWVTP(LCM,200))
    ALLOCATE(STWVDR(LCM,200))
    ALLOCATE(TAU(LCM))
    ALLOCATE(TAUCOR(KB+1,LCM))
    ALLOCATE(TAUCRITE(NSICM))
    ALLOCATE(TCRE(NSCM))
    ALLOCATE(TAULOC(ITBM))
    ALLOCATE(TCRSUS(NSCM))
    ALLOCATE(TRANS(LCM,NSCM))
    ALLOCATE(TSED(KB,LCM))
    ALLOCATE(TSED0(KB,LCM))
    ALLOCATE(TSET0T(LCM))
    ALLOCATE(TSEDT(LCM))
    ALLOCATE(USW(LCM,NSCM))
    ALLOCATE(WVANG(LCM))
    IF( NCALC_BL > 0 )THEN
      ALLOCATE(BLVEL(LCM,NSCM))
      ALLOCATE(CBL(LCM,NSCM))
      ALLOCATE(DBL(LCM,NSCM))
      ALLOCATE(EBL(LCM,NSCM))
      ALLOCATE(UBL(LCM,NSCM))
      ALLOCATE(VBL(LCM,NSCM))
      IF( ISTRAN(5) > 0 )THEN
        ALLOCATE(CBLTOX(LCM,NTXM))
        ALLOCATE(CBLTXCON(LCM,NSCM,NTXM))
      ENDIF
    ENDIF
  ENDIF
  ! End SEDZLJ variables

  ! *** OMP DECLARATIONS
  ALLOCATE(CD(LCM,KCM,NTHREADS))
  ALLOCATE(FQC(LCM,KCM,NTHREADS))
  ALLOCATE(FUHUD(LCM,KCM,NTHREADS))
  ALLOCATE(FVHUD(LCM,KCM,NTHREADS))
  ALLOCATE(FUHVD(LCM,KCM,NTHREADS))
  ALLOCATE(FVHVD(LCM,KCM,NTHREADS))
  ALLOCATE(FWUU(LCM,0:KCM,NTHREADS))
  ALLOCATE(FWVV(LCM,0:KCM,NTHREADS))
  ALLOCATE(FQCPAD(LCM,KCM,NTHREADS))
  ALLOCATE(QSUMNAD(LCM,KCM,NTHREADS))
  ALLOCATE(QSUMPAD(LCM,KCM,NTHREADS))
  ALLOCATE(DUU(LCM,KCM,NTHREADS))
  ALLOCATE(DVV(LCM,KCM,NTHREADS))
  ALLOCATE(POS(LCM,KCM,NTHREADS))
  ALLOCATE(UUUU(LCM,KCM,NTHREADS))
  ALLOCATE(VVVV(LCM,KCM,NTHREADS))
  ALLOCATE(WWWW(LCM,0:KCM,NTHREADS))
  ALLOCATE(CONQ(LCM,KCM,NTHREADS))
  ALLOCATE(CON2(LCM,KCM,NTHREADS))
  ALLOCATE(CMAX(LCM,KCM,NTHREADS))
  ALLOCATE(CMIN(LCM,KCM,NTHREADS))
  ALLOCATE(CONTD(LCM,KCM,NTHREADS))
  ALLOCATE(CONTMN(LCM,KCM,NTHREADS)) 
  ALLOCATE(CONTMX(LCM,KCM,NTHREADS))

  ! Begin MHK variables SCJ
  ALLOCATE(IJLTURB(TCOUNT,3))
  ALLOCATE(CTMHK(MHKTYP))
  ALLOCATE(CDSUP(MHKTYP))
  ALLOCATE(DENMHK(MHKTYP))   ! density of MHK devices (#/cell)
  ALLOCATE(ESUP(TCOUNT,LCM))  
  ALLOCATE(EMHK(TCOUNT,LCM))
  ALLOCATE(FXMHK(LCM,KCM))
  ALLOCATE(FXMHKE(LCM))
  ALLOCATE(FXSUP(LCM,KCM))
  ALLOCATE(FXSUPE(LCM))
  ALLOCATE(FYMHK(LCM,KCM))
  ALLOCATE(FYMHKE(LCM))
  ALLOCATE(FYSUP(LCM,KCM))
  ALLOCATE(FYSUPE(LCM))
  ALLOCATE(PMHK(LCM,KCM))   ! array that accumulates MHK power
  ALLOCATE(PSUP(LCM,KCM))   ! array that accumulates support power losses
  ALLOCATE(VMAXCUT(MHKTYP))
  ALLOCATE(VMINCUT(MHKTYP))
  ALLOCATE(WIDTHMHK(MHKTYP))
  ALLOCATE(WIDTHSUP(MHKTYP))
  ALLOCATE(ZMAXMHK(MHKTYP,LCM))
  ALLOCATE(ZMINMHK(MHKTYP,LCM))
  ALLOCATE(ZMAXSUP(MHKTYP,LCM))
  ALLOCATE(ZMINSUP(MHKTYP,LCM))

  ! *** ALLOCATE MEMORY FOR VARIABLE TO STORE CONCENTRATIONS AT OPEN BOUNDARIES
  ! *** WQBCCON(NBCSOP,KCM,NTHREADS) and WQBCCON1(NBCSOP,KCM,NTHREADS) are to be allocated after NBCSOP is determined
  
  ALLOCATE(FBESER(NBEPAIRM))
  ALLOCATE(BESERT(NBESERM))
  ALLOCATE(FWCBESERT(NBESERM))
  ALLOCATE(TCBESER(NBESERM))
  ALLOCATE(TABESER(NBESERM))
  ALLOCATE(TBESER(NDBESER,NBESERM))
  ALLOCATE(BESER(NDBESER,NBESERM))
  ALLOCATE(FWCBESER(NDBESER,NBESERM))
  ALLOCATE(QSBDTOPBEBKB(LCM))
  ALLOCATE(QSBDTOPBECHB(LCM))
  ALLOCATE(QSBDTOPBECHW(LCM))
  ALLOCATE(QWBDTOPBEBKB(LCM))
  ALLOCATE(QWBDTOPBECHB(LCM))
  ALLOCATE(QWBDTOPBECHW(LCM))
  ALLOCATE(SEDFBEBKB(LCM,NSCM))
  ALLOCATE(SEDFBECHB(LCM,NSCM))
  ALLOCATE(SEDFBECHW(LCM,NSCM))
  ALLOCATE(SNDFBEBKB(LCM,NSNM))
  ALLOCATE(SNDFBECHB(LCM,NSNM))
  ALLOCATE(SNDFBECHW(LCM,NSNM))

  ! *** VARIABLES FOR QCTL NQCTYP=3 & 4 
  ALLOCATE(LOWCHORDU(NQCTL))
  ALLOCATE(LOWCHORDV(NQCTL))
  ALLOCATE(HQCTLU(NQCTL))
  ALLOCATE(HQCTLD(NQCTL))
  ALLOCATE(NLOWCHORD(NQCTL))
  ALLOCATE(SAVESUB(2,NQCTL))
  ALLOCATE(SAVESVB(2,NQCTL))

  ! *** HYDRAULIC STRUCTURE EQUATIONS
  ALLOCATE(HS_FACTOR(NQCTL))
  ALLOCATE(HS_NTIMES(NQCTL))
  ALLOCATE(HS_TRANSITION(NQCTL))
  IF( NHYDST > 0 )THEN
    ALLOCATE(HS_LENGTH(NHYDST))
    ALLOCATE(HS_XSTYPE(NHYDST))
    ALLOCATE(HS_REVERSE(NHYDST))
    ALLOCATE(HS_WIDTH(NHYDST))
    ALLOCATE(HS_HEIGHT(NHYDST))
    ALLOCATE(HS_MANN(NHYDST))
    ALLOCATE(HS_ANGLE(NHYDST))
    ALLOCATE(HS_USELEV(NHYDST))
    ALLOCATE(HS_DSELEV(NHYDST))
    ALLOCATE(HS_COEFF(NHYDST,4))
  ENDIF    
  
  ! *** HYDRAULIC STRUCTURE CONTROLS
  ALLOCATE(HSCTL(NQCTL))
  ALLOCATE(WRCTL(NQWR))
  
  ! *** SIGMA-Z HSTRUCT
  ALLOCATE(KSZ(LCM))
  ALLOCATE(KSZU(LCM))
  ALLOCATE(KSZV(LCM))
  ALLOCATE(BI1W(LCM))
  ALLOCATE(BI2W(LCM))
  ALLOCATE(BEW(LCM))
  ALLOCATE(BI1S(LCM))
  ALLOCATE(BI2S(LCM))
  ALLOCATE(BES(LCM))
  IF( IGRIDV > 0 )THEN
    ALLOCATE(BELVE(LCM))
    ALLOCATE(BELVW(LCM))
    ALLOCATE(BELVN(LCM))
    ALLOCATE(BELVS(LCM))
    ALLOCATE(BE(LCM,KCM))
    ALLOCATE(BW(LCM,KCM))
    ALLOCATE(BN(LCM,KCM))
    ALLOCATE(BS(LCM,KCM))
    ALLOCATE(BEE(LCM))
    ALLOCATE(BEN(LCM))
    ALLOCATE(BI1E(LCM))
    ALLOCATE(BI1N(LCM))
    ALLOCATE(BI2E(LCM))
    ALLOCATE(BI2N(LCM))
    ALLOCATE(HPE(LCM))
    ALLOCATE(HPW(LCM))
    ALLOCATE(HPN(LCM))
    ALLOCATE(HPS(LCM))
    ALLOCATE(KSZE(LCM))
    ALLOCATE(KSZW(LCM))
    ALLOCATE(KSZN(LCM))
    ALLOCATE(KSZS(LCM))
    ALLOCATE(SGZKE(KCM,LCM))
    ALLOCATE(SGZKW(KCM,LCM))
    ALLOCATE(SGZKN(KCM,LCM))
    ALLOCATE(SGZKS(KCM,LCM))
    ALLOCATE(SGZE(LCM,KCM))
    ALLOCATE(SGZW(LCM,KCM))
    ALLOCATE(SGZN(LCM,KCM))
    ALLOCATE(SGZS(LCM,KCM))
    ALLOCATE(ZE(LCM,0:KCM))
    ALLOCATE(ZW(LCM,0:KCM))
    ALLOCATE(ZN(LCM,0:KCM))
    ALLOCATE(ZS(LCM,0:KCM))
    ALLOCATE(ZZE(0:KCM,LCM))
    ALLOCATE(ZZW(0:KCM,LCM))
    ALLOCATE(ZZN(0:KCM,LCM))
    ALLOCATE(ZZS(0:KCM,LCM))
  ENDIF
  ALLOCATE(DZIGSD4U(LCM,KCM))
  ALLOCATE(DZIGSD4V(LCM,KCM))

  ALLOCATE(DZC(LCM,KCM))
  ALLOCATE(DZCK(KCM))
  ALLOCATE(DZCU(LCM,KCM))
  ALLOCATE(DZCV(LCM,KCM))
  ALLOCATE(DZG(LCM,KCM))
  ALLOCATE(DZGU(LCM,KCM))
  ALLOCATE(DZGV(LCM,KCM))
  ALLOCATE(LKSZ(LCM,KCM))

  ALLOCATE(CDZDU(LCM,KSM))
  ALLOCATE(CDZDV(LCM,KSM))
  ALLOCATE(CDZFU(LCM,KSM))
  ALLOCATE(CDZFV(LCM,KSM))
  ALLOCATE(CDZLU(LCM,KSM))
  ALLOCATE(CDZLV(LCM,KSM))
  ALLOCATE(CDZMU(LCM,KSM))
  ALLOCATE(CDZMV(LCM,KSM))
  ALLOCATE(CDZRU(LCM,KSM))
  ALLOCATE(CDZRV(LCM,KSM))
  ALLOCATE(CDZUU(LCM,KSM))
  ALLOCATE(CDZUV(LCM,KSM))

  ALLOCATE(SUB3D(LCM,KCM))
  ALLOCATE(SUB3DO(LCM,KCM))
  ALLOCATE(SVB3D(LCM,KCM))
  ALLOCATE(SVB3DO(LCM,KCM))

  ALLOCATE(SGZU(LCM,KCM))
  ALLOCATE(SGZV(LCM,KCM))
  ALLOCATE(FSGZU(LCM,KCM))
  ALLOCATE(FSGZV(LCM,KCM))
  ALLOCATE(LSGZU(LCM,KCM))
  ALLOCATE(LSGZV(LCM,KCM))

  ALLOCATE(HPK(LCM,KCM))
  ALLOCATE(HPKI(LCM,KCM))
  ALLOCATE(H1PK(LCM,KCM))
  ALLOCATE(H2PK(LCM,KCM))
  ALLOCATE(UHDY(LCM,KCM))
  ALLOCATE(VHDX(LCM,KCM))
  ALLOCATE(UHDY1(LCM,KCM))
  ALLOCATE(VHDX1(LCM,KCM))
  ALLOCATE(UHDY2(LCM,KCM))
  ALLOCATE(VHDX2(LCM,KCM))
  ALLOCATE(UHDYF(LCM,KCM))
  ALLOCATE(VHDXF(LCM,KCM))
  ALLOCATE(UHDYF1(LCM,KCM))
  ALLOCATE(VHDXF1(LCM,KCM))
  ALLOCATE(UHDYF2(LCM,KCM))
  ALLOCATE(VHDXF2(LCM,KCM))

  ! *** WET/DRY BYPASS VARIABLES
  ALLOCATE(LWET(LCM))
  ALLOCATE(LDRY(LCM))
  
  ! *** ATMOS
  IF( NASER >= 1 )THEN
    ALLOCATE(TCASER(NASER),TAASER(NASER),IRELH(NASER),MATLAST(NASER))
  ENDIF
  
  ! *** WIND
  IF( NWSER >= 1 )THEN
    ALLOCATE(TCWSER(NWSER),TAWSER(NWSER))
    ALLOCATE(ISWDINT(NWSER),WINDH(NWSER),MWTLAST(NWSER))
  ENDIF
    
  ! *** ICE
  IF( ISICE > 0 )THEN
    ALLOCATE(MITLAST(NISER))             ! *** ISICE=1  INPUT SERIES LAST INDEX FOR SERIES
    ALLOCATE(FRAZILICE(LCM,KCM))         ! *** ISICE=4 FRAZIL ICE IN EACH CELL AND LAYER (M)
    ALLOCATE(FRAZILICE1(LCM,KCM))        ! *** ISICE=4 FRAZIL ICE IN EACH CELL AND LAYER FOR PREVIOUS TIME STEP (M)
    ALLOCATE(ICECOVER(LCM))              ! *** ISICE>0 FRACTION OF ICE COVER FOR EACH CELL (M)
    ALLOCATE(ICERATE(LCM))               ! *** ISICE>2 WATER FLOW RATE TO/FROM WATER COLUMN (M3/S)
    ALLOCATE(ICETHICK(LCM))              ! *** ISICE>0 ICE THICKNESS FOR EACH CELL (M)
    ALLOCATE(ICETHICK1(LCM))             ! *** ISICE>0 ICE THICKNESS FOR EACH CELL FOR PREVIOUS TIME STEP (M)
    ALLOCATE(ICETEMP(LCM))               ! *** ISICE>0 ICE TEMPERATURE OF EACH CELL (M)
    ALLOCATE(ICEVOL(LCM))                ! *** ISICE>0 INCREMENTAL WATER VOLUMES FOR ICE FORMATION/MELT (M3)
    ALLOCATE(TCISER(NISER))              ! *** ISICE=1  INPUT SERIES TIME CONVERSION
    ALLOCATE(TAISER(NISER))              ! *** ISICE=1  INPUT SERIES (NOT USED)
    ALLOCATE(RICECOVT(NISER))            ! *** ISICE=1  INPUT ICE COVER AT CURRENT TIME
    ALLOCATE(RICETHKT(NISER))            ! *** ISICE=1  INPUT ICE THICKNESS AT CURRENT TIME
  ENDIF
  ALLOCATE(ICECELL(LCM))                 ! *** ISICE>0  PERFORM ICE COMPUTATIONS
  ALLOCATE(RHOW(LCM,KCM))                ! *** DENSITY OF WATER KG/M3, FROM CALBUOY
  
  IF( ISLSHA > 0 .OR. ISHTA >0 )THEN
    ALLOCATE(AMCP(LCM))
    ALLOCATE(AMCU(LCM,KCM))
    ALLOCATE(AMCUE(LCM))
    ALLOCATE(AMCV(LCM,KCM))
    ALLOCATE(AMCVE(LCM))
    ALLOCATE(AMPU(MTM))
    ALLOCATE(AMPV(MTM))
    ALLOCATE(AMSP(LCM))
    ALLOCATE(AMSU(LCM,KCM))
    ALLOCATE(AMSUE(LCM))
    ALLOCATE(AMSV(LCM,KCM))
    ALLOCATE(AMSVE(LCM))
  ENDIF
      
END

