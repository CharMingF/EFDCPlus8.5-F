

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>2. Running &mdash; EFDC+ Documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Cartesian Grid Generator User Guide" href="../gridgen/index.html" />
    <link rel="prev" title="1. Build Instructions" href="build.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> EFDCPlus
          

          
            
            <img src="../_static/eems-logo-80px.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                8.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Getting Started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="build.html">1. Build Instructions</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">2. Running</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#execution-options">2.1. Execution Options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#multithreading-with-openmp">2.1.1. Multithreading with OpenMP</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#executing-and-efdc-run">2.2. Executing and EFDC+ Run</a></li>
<li class="toctree-l3"><a class="reference internal" href="#output-screen">2.3. Output Screen</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gridgen/index.html">Cartesian Grid Generator User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../inputfiles/index.html">Input Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../outputfiles/index.html">Output Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samplemodels/index.html">Sample Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">EFDCPlus</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Getting Started</a> &raquo;</li>
        
      <li>2. Running</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/started/running.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="running">
<span id="id1"></span><h1>2. Running<a class="headerlink" href="#running" title="Permalink to this headline">¶</a></h1>
<p>Running EFDC+ on a local computer can be done in several different ways.  By far the simplest way is to use the EFDC Explorer.  The EFDC Explorer is a Graphical User Interface (GUI) that allows EFDC+ models to be visualized and run with ease. Details on the EFDC Explorer can be found <a class="reference external" href="https://www.eemodelingsystem.com/">here</a>.   Alternatively, the EFDC executable can be run through the command prompt or using a batch script.</p>
<p>For this discussion it is assumed the user is not using the EFDC Explorer.</p>
<div class="section" id="execution-options">
<h2>2.1. Execution Options<a class="headerlink" href="#execution-options" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Serial: EFDC+ can be run simply on a single core of a user’s desktop.  No special compilation is required for this option.</li>
<li>Multithreaded: If the executable was compiled with OpenMP libraries, multiple cores on a single machine may be utilized.</li>
</ul>
<div class="section" id="multithreading-with-openmp">
<h3>2.1.1. Multithreading with OpenMP<a class="headerlink" href="#multithreading-with-openmp" title="Permalink to this headline">¶</a></h3>
<p>With the advent of Intel processors with multiple cores, various technologies have been employed to take advantage of this increased computational power.  With DSI’s knowledge of the EFDC+ code and its structure, the approach selected to apply multi-threading to EFDC was OpenMP.</p>
<p>Additionally, Intel has implemented Hyper-Threading for their multi-core implementation.  This allows a program to utilize two threads for each physical core.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Since two threads share a single core, for computationally intensive applications, only using the number of threads equal to the number of cores provides the best throughput</p>
</div>
<div class="section" id="openmp-performance">
<h4>2.1.1.1. OpenMP Performance<a class="headerlink" href="#openmp-performance" title="Permalink to this headline">¶</a></h4>
<p>The performance of the different routines within EFDC+ using OpenMP is highlighted in the figure below.</p>
<p><img alt="omp_perf" src="../_images/omp_performance.png" /></p>
<p>It is DSI’s commitment that the EFDC_DSI_OMP models produce exactly the same results regardless of how many threads are used.  Model comparisons demonstrate model differences are equal to zero  i.e. model results are exactly the same, within model precision.</p>
</div>
</div>
</div>
<div class="section" id="executing-and-efdc-run">
<h2>2.2. Executing and EFDC+ Run<a class="headerlink" href="#executing-and-efdc-run" title="Permalink to this headline">¶</a></h2>
<p>Once an EFDC+ executable is available, it can be run directly through the command prompt or through simple batch script.  A sample of batch script is given below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SET</span> <span class="n">KMP_AFFINITY</span><span class="o">=</span><span class="n">granularity</span><span class="o">=</span><span class="n">fine</span><span class="p">,</span><span class="n">compact</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span>

<span class="n">TITLE</span> <span class="n">Sample</span> <span class="n">Title</span> <span class="n">of</span> <span class="n">the</span> <span class="n">Problem</span>

<span class="n">CD</span> <span class="s2">&quot;C:\Path\To\WorkingDirectory</span><span class="se">\&quot;</span>

<span class="s2">&quot;C:\Path\To\Exectuable\EFDCPlus.exe&quot;</span> <span class="o">-</span><span class="n">NT2</span> <span class="o">-</span><span class="n">NOP</span>

</pre></div>
</div>
<p>Each line the script is described in greater detail below.</p>
<ul class="simple">
<li>SET KMP_AFFINITY=granularity=fine,compact,1,0 - Specifies an environment variable that binds OpenMP threads to physical processing units. This generally gives the best performance.  For additional information on what this environment variable is doing, go to <a class="reference external" href="https://software.intel.com/en-us/articles/using-kmp-affinity-to-create-openmp-thread-mapping-to-os-proc-ids">this article</a>, written by Intel.</li>
<li>TITLE: A title is optional but can be helpful if you are running multiple calculations at the same time.  This title will show up at the top of the command prompt.</li>
<li>CD: This command precedes the location of your <cite>Working Directory</cite>, which is the folder containing your EFDC+ inputs.</li>
<li>The path to the location of the executable must be known and specified in the script.</li>
<li>-NT2: This command line argument after the executable specifies the number of threads to use.  In this case only 2 are requested, but one could easily specify 3,4,5, etc. to run more threads.</li>
</ul>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Do not specify a number of threads greater than the number of logical cores available on your computer.</p>
</div>
</div>
<div class="section" id="output-screen">
<h2>2.3. Output Screen<a class="headerlink" href="#output-screen" title="Permalink to this headline">¶</a></h2>
<p>The EFDC+ end of run screen contains the CPU usage for the run.  The CPU usage is reported as the Total CPU/# Cores. This statistic is best for interpreting impacts to run times.  A sample of an output screen is given below.</p>
<p><img alt="eor_screen" src="../_images/eor_screen.png" /></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../gridgen/index.html" class="btn btn-neutral float-right" title="Cartesian Grid Generator User Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="build.html" class="btn btn-neutral float-left" title="1. Build Instructions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright DSI, LLC

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>